#$Id: Giovanni-UnitsConversion_scatter.t,v 1.4 2015/03/17 17:01:29 csmit Exp $
#-@@@ Giovanni, Version $Name:  $
# Before `make install' is performed this script should be runnable with
# `make test'. After `make install' it should work as `perl Giovanni-UnitsConversion.t'

#########################

# change 'tests => 1' to 'tests => last_test_to_print';

use Test::More tests => 3;
BEGIN { use_ok('Giovanni::UnitsConversion') }

#########################

# Insert your test code below, the Test::More module is use()ed here so read
# its man page ( perldoc Test::More ) for help writing this test script.

use warnings;
use strict;
use Giovanni::Data::NcFile;
use File::Temp qq/tempdir/;

##################
# Do a test with a scatter plot file, which has two variables that can be
# converted.
##################

my $dir = tempdir( CLEANUP => 1 );

my ( $inCdl, $correctCdl ) = readCdlData();

my $dataFile
    = "$dir/timeAvgMap.TRMM_3B42_daily_precipitation_V7.20030101-20030101.80W_29N_77W_31N.nc";
Giovanni::Data::NcFile::write_netcdf_file( $dataFile, $inCdl )
    or die "Unable to write input file.";

my $conversionCfg = <<XML;
<units>
    <linearConversions>
        <linearUnit source="mm/day" destination="mm/hr" scale_factor="1.0/24.0"
            add_offset="0" />
        <linearUnit source="mm/day" destination="inch/day"
            scale_factor="1.0/25.4" add_offset="0" />
    </linearConversions>
    <nonLinearConversions>
        <timeDependentUnit source="mm/hr" destination="mm/month"
            class="Giovanni::UnitsConversion::MonthlyAccumulation" />
    </nonLinearConversions>
</units>
XML
my $cfg = "$dir/cfg.xml";
open( CFG, ">", $cfg );
print CFG $conversionCfg;
close(CFG);

my $converter = Giovanni::UnitsConversion->new( config => $cfg );
$converter->addConversion(
    sourceUnits      => 'mm/day',
    destinationUnits => 'inch/day',
    variable         => 'x_TRMM_3B42_daily_precipitation_V6',
    type             => 'float',
);

$converter->addConversion(
    sourceUnits      => 'mm/day',
    destinationUnits => 'mm/hr',
    variable         => 'y_TRMM_3B42_daily_precipitation_V7',
    type             => 'float',
);

my $destFile = "$dir/out.nc";
my $ret      = $converter->ncConvert(
    sourceFile      => $dataFile,
    destinationFile => $destFile
);

ok( $ret, "conversion returned true" );

# remove the history from the output file
my $cmd = "ncatted -O -h -a 'history,global,d,,,' $destFile $destFile";
$ret = system($cmd);

if ( $ret != 0 ) {
    die "Unable to remove history";
}

# write the correct output CDL to a file
my $correctNc = "$dir/correct.nc";
Giovanni::Data::NcFile::write_netcdf_file( $correctNc, $correctCdl )
    or die "Unable to write comparison output file.";

my $out
    = Giovanni::Data::NcFile::diff_netcdf_files( $destFile, $correctNc );

is( $out, '', "Same output: $out" );

sub readCdlData {

    # read block at __DATA__ and write to a CDL file
    #(stolen from Chris...)
    my @cdldata;
    while (<DATA>) {
        push @cdldata, $_;
    }
    my $allCdf = join( '', @cdldata );

    # now divide up
    my @cdl = ( $allCdf =~ m/(netcdf .*?\}\n)/gs );
    return @cdl;
}

__DATA__
netcdf pairedData.TRMM_3B42_daily_precipitation_V6+TRMM_3B42_daily_precipitation_V7.20030101-20030101.87W_37N_82W_41N {
dimensions:
    time = UNLIMITED ; // (1 currently)
    lat = 16 ;
    lon = 20 ;
variables:
    int dataday(time) ;
        dataday:long_name = "Standardized Date Label" ;
    double lat(lat) ;
        lat:standard_name = "latitude" ;
        lat:units = "degrees_north" ;
    double lon(lon) ;
        lon:standard_name = "longitude" ;
        lon:units = "degrees_east" ;
    double time(time) ;
        time:standard_name = "time" ;
        time:units = "seconds since 1970-01-01 00:00:00" ;
    float x_TRMM_3B42_daily_precipitation_V6(time, lat, lon) ;
        x_TRMM_3B42_daily_precipitation_V6:_FillValue = -9999.f ;
        x_TRMM_3B42_daily_precipitation_V6:coordinates = "time lat lon" ;
        x_TRMM_3B42_daily_precipitation_V6:grid_name = "grid-1" ;
        x_TRMM_3B42_daily_precipitation_V6:grid_type = "linear" ;
        x_TRMM_3B42_daily_precipitation_V6:level_description = "Earth surface" ;
        x_TRMM_3B42_daily_precipitation_V6:long_name = "Precipitation Rate" ;
        x_TRMM_3B42_daily_precipitation_V6:product_short_name = "TRMM_3B42_daily" ;
        x_TRMM_3B42_daily_precipitation_V6:product_version = "6" ;
        x_TRMM_3B42_daily_precipitation_V6:quantity_type = "Precipitation" ;
        x_TRMM_3B42_daily_precipitation_V6:standard_name = "r" ;
        x_TRMM_3B42_daily_precipitation_V6:units = "mm/day" ;
        x_TRMM_3B42_daily_precipitation_V6:plot_hint_axis_title = "Precipitation Rate daily 0.25 deg. [TRMM TRMM_3B42_daily v6] mm/day" ;
    float y_TRMM_3B42_daily_precipitation_V7(time, lat, lon) ;
        y_TRMM_3B42_daily_precipitation_V7:_FillValue = -9999.9f ;
        y_TRMM_3B42_daily_precipitation_V7:coordinates = "time lat lon" ;
        y_TRMM_3B42_daily_precipitation_V7:grid_name = "grid-1" ;
        y_TRMM_3B42_daily_precipitation_V7:grid_type = "linear" ;
        y_TRMM_3B42_daily_precipitation_V7:level_description = "Earth surface" ;
        y_TRMM_3B42_daily_precipitation_V7:long_name = "Precipitation Rate" ;
        y_TRMM_3B42_daily_precipitation_V7:product_short_name = "TRMM_3B42_daily" ;
        y_TRMM_3B42_daily_precipitation_V7:product_version = "7" ;
        y_TRMM_3B42_daily_precipitation_V7:quantity_type = "Precipitation" ;
        y_TRMM_3B42_daily_precipitation_V7:standard_name = "r" ;
        y_TRMM_3B42_daily_precipitation_V7:units = "mm/day" ;
        y_TRMM_3B42_daily_precipitation_V7:plot_hint_axis_title = "Precipitation Rate daily 0.25 deg. [TRMM TRMM_3B42_daily v7] mm/day" ;

// global attributes:
        :Conventions = "CF-1.4" ;
        :NCO = "4.3.1" ;
        :temporal_resolution = "daily" ;
        :nco_openmp_thread_number = 1 ;
        :matched_start_time = "2003-01-01T00:00:00Z" ;
        :matched_end_time = "2003-01-01T23:59:59Z" ;
        :title = "Data match (87.1875W - 82.2656W, 37.3828N - 41.6016N): TRMM_3B42_daily.6 TRMM_3B42_daily.7" ;
        :plot_hint_title = "Region 87.1875W, 37.3828N, 82.2656W, 41.6016N" ;
        :plot_hint_subtitle = "2003-01-01" ;
        :plot_hint_caption = "- Selected date range was 2003-01-01 - 2003-01-01. The data date range for the first variable, Precipitation Rate daily 0.25 deg. [TRMM TRMM_3B42_daily v6] mm/day, is 2002-12-31 22:30Z - 2003-01-01 22:29Z. The data date range for the second variable, Precipitation Rate daily 0.25 deg. [TRMM TRMM_3B42_daily v7] mm/day, is 2002-12-31 22:30Z - 2003-01-01 22:29Z." ;
data:

 dataday = 2003001 ;

 lat = 37.625, 37.875, 38.125, 38.375, 38.625, 38.875, 39.125, 39.375, 
    39.625, 39.875, 40.125, 40.375, 40.625, 40.875, 41.125, 41.375 ;

 lon = -87.125, -86.875, -86.625, -86.375, -86.125, -85.875, -85.625, 
    -85.375, -85.125, -84.875, -84.625, -84.375, -84.125, -83.875, -83.625, 
    -83.375, -83.125, -82.875, -82.625, -82.375 ;

 time = 1041373800 ;

 x_TRMM_3B42_daily_precipitation_V6 =
  14.22, 14.4322, 15.4012, 14.91015, 14.2115, 15.20586, 19.22588, 10.14, 
    9.66, 7.5, 6.54, 6.9, 23.22, 33.96, 38.5789, 44.18182, 42.61916, 
    39.19711, 32.69736, 22.23521,
  5.538629, 11.98279, 17.32091, 18.50871, 17.05615, 17.43259, 16.75371, 
    16.5179, 23.18708, 25.26885, 17.7, 12.18, 29.1, 33.71471, 49.76756, 
    53.16729, 46.17864, 38.56094, 37.58491, 22.98,
  11.94, 9.719999, 18.24, 22.98058, 20.47308, 17.94, 13.44, 11.16, 13.08525, 
    20.90219, 32.16047, 28.5751, 27.50159, 35.59409, 38.40062, 45.68684, 
    43.37067, 35.34857, 29.58, 16.74,
  0, 7.74, 20.21744, 22.95881, 22.26921, 20.46452, 20.28016, 16.17979, 
    16.18691, 24.62667, 21.98467, 28.85999, 31.63944, 38.32573, 42.96753, 
    43.81899, 45.8254, 41.94034, 39.18197, 33.57029,
  0, 7.98, 17.58, 14.22, 12.96, 12.6, 18.24, 20.29554, 19.70264, 24.06931, 
    23.86466, 26.96692, 28.71516, 32.76479, 31.50737, 40.17035, 41.84933, 
    42.54834, 43.04108, 41.29854,
  0, 5.04, 6.608186, 7.344155, 2.94, 0, 7.44, 16.47626, 26.60656, 27.47926, 
    24.93781, 24.26955, 25.36382, 26.0923, 27.2664, 31.46515, 35.13245, 
    32.80143, 37.20613, 36.30742,
  0, 2.64, 7.56, 9.18, 6.18, 12.78, 13.10259, 10.8, 21.9267, 23.75317, 
    22.44838, 22.62535, 25.33765, 20.71415, 20.5658, 22.10351, 26.27875, 
    27.92898, 30.8833, 32.34291,
  0, 8.52, 0, 0, 2.602025, 6.635588, 6.851954, 17.87086, 27.06, 27.84, 23.04, 
    23.04, 23.04, 18.66579, 13.46654, 11.33129, 17.89293, 22.30313, 28.54576, 
    33.23774,
  2.58, 0, 0, 1.613936, 3.319258, 4.114298, 6.399493, 9.637835, 18.0056, 
    15.18585, 12.60297, 17.37848, 20.45516, 17.33173, 17.93274, 14.63811, 
    16.39011, 18.96041, 25.6983, 34.98352,
  3.453223, 3.357438, 1.228591, 3.09277, 3.464271, 5.330567, 8.667478, 
    11.83654, 15.26535, 12.10841, 16.34251, 13.14511, 19.94263, 13.59005, 
    14.03849, 19.45343, 20.32219, 22.3144, 25.51092, 28.39186,
  2.548904, 4.319928, 4.362707, 5.217634, 6.279418, 10.63067, 13.12054, 
    12.24698, 13.01623, 14.58013, 19.20392, 13.33358, 16.05091, 11.25204, 
    13.29415, 16.95111, 16.69166, 12.756, 19.25862, 24.58858,
  2.634518, 4.602264, 5.700277, 6.5622, 6.804142, 8.964795, 9.935395, 
    8.83334, 10.31518, 9.022039, 8.641665, 7.013631, 7.971621, 7.666368, 
    9.651617, 10.83254, 13.01867, 9.769852, 10.84452, 17.63937,
  2.310477, 4.51122, 10.30059, 11.3252, 7.691378, 8.283601, 10.97903, 
    10.32147, 9.846781, 9.353528, 9.096661, 8.960171, 9.561677, 6.389811, 
    6.349269, 7.483509, 8.505938, 7.040219, 11.07428, 18.50402,
  1.995417, 6.994702, 11.02286, 12.47011, 11.72206, 8.204289, 7.579031, 
    6.137727, 7.424649, 6.208801, 6.331369, 9.787521, 9.572211, 7.73258, 
    6.398545, 6.969041, 8.43765, 6.995325, 12.90991, 16.10798,
  3.571539, 8.082974, 10.78848, 8.200233, 10.07205, 10.80912, 8.219683, 
    6.630335, 7.087093, 6.404876, 5.832431, 7.526804, 7.168964, 7.196209, 
    8.721798, 5.23087, 6.804481, 7.732422, 14.57236, 18.22341,
  2.792829, 5.625251, 6.675257, 8.709959, 7.722739, 8.486705, 6.581734, 
    4.292334, 3.580217, 5.287893, 5.71977, 5.602406, 5.92114, 6.928878, 
    7.440638, 10.88639, 9.18934, 10.85719, 15.33411, 22.95079 ;

 y_TRMM_3B42_daily_precipitation_V7 =
  25.2, 22.72251, 23.78569, 43.21998, 44.33489, 49.24601, 46.08, 38.52, 21.6, 
    20.43, 35.70631, 38.35194, 46.28281, 40.05, 44.37751, 43.88701, 40.24716, 
    35.20823, 24.53625, 0,
  36.9, 31.4728, 31.50626, 32.89681, 29.58161, 29.61, 23.04, 24.12, 32.97773, 
    34.2, 30.73363, 43.29692, 43.2745, 42.80653, 48.21657, 46.776, 41.03873, 
    31.96199, 33.08934, 31.23,
  39.16909, 44.96584, 42.73759, 37.05982, 10.26, 16.92, 3.96, 14.94, 
    27.45008, 36.18676, 34.98885, 48.50549, 46.59521, 48.40207, 49.17526, 
    49.0739, 44.43454, 36.94057, 26.19, 24.3,
  23.27513, 29.54846, 44.11356, 38.48136, 37.80986, 30.3656, 29.53062, 
    27.44607, 28.78566, 34.50019, 36.6302, 42.91946, 45.3093, 48.76833, 
    48.18589, 46.61114, 50.56014, 45.17682, 39.63494, 43.28004,
  10.44, 16.83, 32.18724, 30.97322, 34.01321, 34.76009, 33.81977, 37.93932, 
    38.85991, 36.89985, 35.39763, 40.27628, 40.78272, 46.47052, 49.07088, 
    50.66383, 52.74974, 51.05229, 47.90174, 45.05657,
  7.2, 8.132115, 13.37995, 14.13, 18.09, 27.56549, 24.90978, 35.83533, 
    42.72348, 39.45909, 33.98946, 37.31868, 37.66258, 42.58659, 42.42561, 
    43.91101, 49.18687, 48.98893, 51.08354, 46.86321,
  6.84, 7.2, 20.23461, 11.88, 9.719999, 29.07, 31.39458, 36.52213, 42.93, 
    37.27619, 37.8054, 35.54653, 34.38059, 30.89625, 30.73309, 37.85477, 
    38.32742, 42.85802, 45.7646, 50.58806,
  0.63, 4.32, 9.18, 9.18, 9.809999, 21.23623, 29.17382, 37.28392, 48.68999, 
    41.73663, 32.40425, 26.97021, 23.07204, 23.75614, 25.10368, 30.09049, 
    35.79977, 27.25586, 37.10598, 43.42999,
  7.876268, 2.688995, 0, 7.901912, 7.208881, 12.52493, 21.3374, 26.69643, 
    34.74, 24.01645, 19.30793, 20.23925, 26.13922, 25.71016, 29.90158, 
    27.61949, 29.95945, 29.389, 34.12065, 40.26385,
  7.490937, 6.547178, 5.034859, 7.976273, 9.382529, 14.64512, 20.14228, 
    27.94288, 25.94841, 17.04176, 14.8057, 17.97896, 22.51594, 21.41018, 
    27.83339, 33.35581, 34.21621, 37.09163, 30.82898, 30.6669,
  7.134232, 11.5389, 10.76559, 12.18416, 11.76132, 19.06788, 20.48349, 
    19.58129, 18.91924, 13.2359, 15.68781, 18.83188, 23.27393, 18.38811, 
    24.05396, 31.91006, 33.79707, 33.82845, 33.25153, 29.09125,
  8.419163, 13.74874, 15.08253, 15.91003, 15.47968, 20.54203, 21.76959, 
    17.16956, 13.76457, 11.49149, 11.06171, 16.8764, 15.65781, 13.70726, 
    17.75821, 17.8791, 21.62709, 13.96519, 18.65479, 28.07845,
  6.707908, 11.04391, 16.35524, 13.61362, 11.24909, 10.84767, 16.09319, 
    15.13451, 14.6604, 11.57941, 12.70203, 15.30803, 9.651569, 8.64763, 
    9.300714, 12.67037, 14.41174, 12.97641, 12.42854, 21.4105,
  4.072186, 10.52011, 14.00615, 17.03806, 17.36519, 11.023, 8.815783, 
    9.37388, 10.60572, 11.5412, 12.7365, 12.69717, 15.88972, 11.16111, 
    8.715604, 9.758363, 10.75362, 13.51311, 19.46541, 25.70606,
  4.905692, 7.092037, 13.6897, 12.82253, 13.50254, 17.20344, 12.30902, 
    11.34686, 11.40534, 9.927551, 7.835724, 11.4762, 11.4412, 10.42112, 
    9.374564, 7.896532, 8.384874, 8.959911, 11.53458, 17.237,
  3.905998, 5.814478, 6.935125, 7.780433, 6.206369, 9.574646, 9.551303, 
    6.717941, 5.988844, 8.715994, 9.268176, 9.384516, 9.329917, 11.20075, 
    11.99148, 14.52692, 16.14959, 12.95861, 19.17901, 17.47784 ;
}
netcdf out {
dimensions:
    time = UNLIMITED ; // (1 currently)
    lat = 16 ;
    lon = 20 ;
variables:
    float x_TRMM_3B42_daily_precipitation_V6(time, lat, lon) ;
        x_TRMM_3B42_daily_precipitation_V6:_FillValue = -9999.f ;
        x_TRMM_3B42_daily_precipitation_V6:coordinates = "time lat lon" ;
        x_TRMM_3B42_daily_precipitation_V6:grid_name = "grid-1" ;
        x_TRMM_3B42_daily_precipitation_V6:grid_type = "linear" ;
        x_TRMM_3B42_daily_precipitation_V6:level_description = "Earth surface" ;
        x_TRMM_3B42_daily_precipitation_V6:long_name = "Precipitation Rate" ;
        x_TRMM_3B42_daily_precipitation_V6:plot_hint_axis_title = "Precipitation Rate daily 0.25 deg. [TRMM TRMM_3B42_daily v6] mm/day" ;
        x_TRMM_3B42_daily_precipitation_V6:product_short_name = "TRMM_3B42_daily" ;
        x_TRMM_3B42_daily_precipitation_V6:product_version = "6" ;
        x_TRMM_3B42_daily_precipitation_V6:quantity_type = "Precipitation" ;
        x_TRMM_3B42_daily_precipitation_V6:standard_name = "r" ;
        x_TRMM_3B42_daily_precipitation_V6:units = "inch/day" ;
    float y_TRMM_3B42_daily_precipitation_V7(time, lat, lon) ;
        y_TRMM_3B42_daily_precipitation_V7:_FillValue = -9999.9f ;
        y_TRMM_3B42_daily_precipitation_V7:coordinates = "time lat lon" ;
        y_TRMM_3B42_daily_precipitation_V7:grid_name = "grid-1" ;
        y_TRMM_3B42_daily_precipitation_V7:grid_type = "linear" ;
        y_TRMM_3B42_daily_precipitation_V7:level_description = "Earth surface" ;
        y_TRMM_3B42_daily_precipitation_V7:long_name = "Precipitation Rate" ;
        y_TRMM_3B42_daily_precipitation_V7:plot_hint_axis_title = "Precipitation Rate daily 0.25 deg. [TRMM TRMM_3B42_daily v7] mm/day" ;
        y_TRMM_3B42_daily_precipitation_V7:product_short_name = "TRMM_3B42_daily" ;
        y_TRMM_3B42_daily_precipitation_V7:product_version = "7" ;
        y_TRMM_3B42_daily_precipitation_V7:quantity_type = "Precipitation" ;
        y_TRMM_3B42_daily_precipitation_V7:standard_name = "r" ;
        y_TRMM_3B42_daily_precipitation_V7:units = "mm/hr" ;
    int dataday(time) ;
        dataday:long_name = "Standardized Date Label" ;
    double lat(lat) ;
        lat:standard_name = "latitude" ;
        lat:units = "degrees_north" ;
    double lon(lon) ;
        lon:standard_name = "longitude" ;
        lon:units = "degrees_east" ;
    double time(time) ;
        time:standard_name = "time" ;
        time:units = "seconds since 1970-01-01 00:00:00" ;

// global attributes:
        :Conventions = "CF-1.4" ;
        :NCO = "4.3.1" ;
        :temporal_resolution = "daily" ;
        :nco_openmp_thread_number = 1 ;
        :matched_start_time = "2003-01-01T00:00:00Z" ;
        :matched_end_time = "2003-01-01T23:59:59Z" ;
        :title = "Data match (87.1875W - 82.2656W, 37.3828N - 41.6016N): TRMM_3B42_daily.6 TRMM_3B42_daily.7" ;
        :plot_hint_title = "Region 87.1875W, 37.3828N, 82.2656W, 41.6016N" ;
        :plot_hint_subtitle = "2003-01-01" ;
        :plot_hint_caption = "- Selected date range was 2003-01-01 - 2003-01-01. The data date range for the first variable, Precipitation Rate daily 0.25 deg. [TRMM TRMM_3B42_daily v6] mm/day, is 2002-12-31 22:30Z - 2003-01-01 22:29Z. The data date range for the second variable, Precipitation Rate daily 0.25 deg. [TRMM TRMM_3B42_daily v7] mm/day, is 2002-12-31 22:30Z - 2003-01-01 22:29Z." ;
data:

 x_TRMM_3B42_daily_precipitation_V6 =
  0.5598425, 0.5681969, 0.6063465, 0.5870138, 0.5595079, 0.5986559, 
    0.7569244, 0.3992126, 0.3803149, 0.2952756, 0.2574803, 0.2716535, 
    0.9141732, 1.337008, 1.518854, 1.739442, 1.67792, 1.543193, 1.287298, 
    0.875402,
  0.2180563, 0.4717634, 0.6819256, 0.7286894, 0.671502, 0.6863225, 0.6595949, 
    0.6503111, 0.9128772, 0.9948366, 0.6968504, 0.4795276, 1.145669, 
    1.327351, 1.959353, 2.0932, 1.818057, 1.518147, 1.479721, 0.9047244,
  0.4700787, 0.3826771, 0.7181102, 0.9047472, 0.8060268, 0.7062992, 
    0.5291339, 0.4393701, 0.5151673, 0.8229209, 1.26616, 1.125004, 1.08274, 
    1.401342, 1.511835, 1.798694, 1.707507, 1.391676, 1.164567, 0.6590551,
  0, 0.3047244, 0.7959622, 0.9038902, 0.8767406, 0.8056898, 0.7984315, 
    0.6369996, 0.6372799, 0.9695539, 0.8655382, 1.13622, 1.245647, 1.508887, 
    1.691635, 1.725157, 1.80415, 1.651194, 1.542597, 1.321665,
  0, 0.3141732, 0.692126, 0.5598425, 0.5102362, 0.496063, 0.7181102, 
    0.799037, 0.7756945, 0.9476106, 0.9395536, 1.06169, 1.130518, 1.289952, 
    1.240448, 1.58151, 1.647611, 1.675131, 1.694531, 1.625927,
  0, 0.1984252, 0.2601648, 0.28914, 0.115748, 0, 0.2929134, 0.6486716, 
    1.047502, 1.081861, 0.9818036, 0.9554941, 0.9985756, 1.027256, 1.07348, 
    1.238786, 1.383167, 1.291395, 1.464808, 1.429426,
  0, 0.103937, 0.2976378, 0.3614173, 0.2433071, 0.5031496, 0.51585, 
    0.4251969, 0.8632559, 0.9351642, 0.8837945, 0.8907619, 0.9975453, 
    0.8155177, 0.8096772, 0.8702169, 1.034596, 1.099566, 1.215878, 1.273343,
  0, 0.3354331, 0, 0, 0.1024419, 0.2612436, 0.269762, 0.7035772, 1.065354, 
    1.096063, 0.9070867, 0.9070867, 0.9070867, 0.7348737, 0.5301787, 
    0.4461138, 0.704446, 0.878076, 1.123849, 1.308572,
  0.1015748, 0, 0, 0.06354079, 0.1306794, 0.1619802, 0.2519486, 0.3794423, 
    0.7088819, 0.5978681, 0.4961799, 0.6841922, 0.8053213, 0.6823516, 
    0.7060134, 0.5763035, 0.6452799, 0.7464728, 1.011744, 1.377304,
  0.1359537, 0.1321826, 0.04836972, 0.1217626, 0.1363886, 0.2098648, 
    0.3412393, 0.4660055, 0.600998, 0.476709, 0.6434059, 0.517524, 0.785143, 
    0.5350413, 0.5526965, 0.7658831, 0.8000862, 0.8785197, 1.004367, 1.11779,
  0.1003506, 0.1700759, 0.1717601, 0.2054187, 0.2472212, 0.4185303, 
    0.5165567, 0.4821646, 0.51245, 0.5740209, 0.7560599, 0.5249441, 
    0.6319256, 0.4429937, 0.5233917, 0.6673666, 0.6571519, 0.5022047, 
    0.7582133, 0.9680543,
  0.1037212, 0.1811915, 0.2244204, 0.2583543, 0.2678796, 0.3529447, 
    0.3911573, 0.3477693, 0.4061095, 0.3551984, 0.340223, 0.2761272, 
    0.3138433, 0.3018255, 0.3799849, 0.4264779, 0.5125461, 0.3846398, 
    0.4269496, 0.6944634,
  0.09096366, 0.1776071, 0.405535, 0.445874, 0.3028102, 0.326126, 0.4322453, 
    0.4063571, 0.3876685, 0.3682491, 0.3581362, 0.3527626, 0.376444, 
    0.2515674, 0.2499712, 0.2946264, 0.3348794, 0.277174, 0.4359953, 0.7285048,
  0.07855973, 0.275382, 0.4339708, 0.4909492, 0.4614984, 0.3230035, 
    0.2983871, 0.2416428, 0.292309, 0.244441, 0.2492665, 0.3853355, 
    0.3768587, 0.3044323, 0.2519112, 0.2743717, 0.3321909, 0.2754065, 
    0.5082642, 0.6341725,
  0.1406118, 0.3182274, 0.4247433, 0.3228438, 0.3965374, 0.4255559, 
    0.3236096, 0.2610368, 0.2790194, 0.2521605, 0.2296233, 0.2963309, 
    0.2822427, 0.2833153, 0.3433779, 0.2059398, 0.267893, 0.304426, 0.573715, 
    0.7174571,
  0.1099539, 0.2214666, 0.2628054, 0.3429118, 0.3040448, 0.3341222, 
    0.2591234, 0.1689895, 0.1409534, 0.2081848, 0.2251878, 0.2205672, 
    0.2331158, 0.2727905, 0.2929385, 0.428598, 0.361785, 0.4274484, 
    0.6037051, 0.9035744 ;

 y_TRMM_3B42_daily_precipitation_V7 =
  1.05, 0.9467712, 0.9910704, 1.800832, 1.847287, 2.051917, 1.92, 1.605, 0.9, 
    0.85125, 1.487763, 1.597998, 1.92845, 1.66875, 1.849063, 1.828625, 
    1.676965, 1.46701, 1.022344, 0,
  1.5375, 1.311367, 1.312761, 1.3707, 1.232567, 1.23375, 0.96, 1.005, 
    1.374072, 1.425, 1.280568, 1.804038, 1.803104, 1.783605, 2.009024, 1.949, 
    1.709947, 1.33175, 1.378723, 1.30125,
  1.632045, 1.873577, 1.780733, 1.544159, 0.4275, 0.705, 0.165, 0.6225, 
    1.143753, 1.507782, 1.457869, 2.021062, 1.941467, 2.016753, 2.048969, 
    2.044746, 1.851439, 1.53919, 1.09125, 1.0125,
  0.9697971, 1.231186, 1.838065, 1.60339, 1.575411, 1.265233, 1.230443, 
    1.143586, 1.199402, 1.437508, 1.526258, 1.788311, 1.887887, 2.032014, 
    2.007746, 1.942131, 2.106673, 1.882367, 1.651456, 1.803335,
  0.435, 0.70125, 1.341135, 1.290551, 1.417217, 1.448337, 1.409157, 1.580805, 
    1.619163, 1.537494, 1.474901, 1.678178, 1.69928, 1.936272, 2.04462, 
    2.110993, 2.197906, 2.127179, 1.995906, 1.877357,
  0.3, 0.3388381, 0.5574979, 0.58875, 0.75375, 1.148562, 1.037907, 1.493139, 
    1.780145, 1.644129, 1.416227, 1.554945, 1.569274, 1.774441, 1.767734, 
    1.829625, 2.049453, 2.041205, 2.128481, 1.952634,
  0.285, 0.3, 0.8431087, 0.495, 0.405, 1.21125, 1.308107, 1.521755, 1.78875, 
    1.553175, 1.575225, 1.481105, 1.432525, 1.287344, 1.280545, 1.577282, 
    1.596976, 1.785751, 1.906858, 2.107836,
  0.02625, 0.18, 0.3825, 0.3825, 0.40875, 0.8848429, 1.215576, 1.553497, 
    2.02875, 1.739026, 1.350177, 1.123759, 0.961335, 0.9898391, 1.045987, 
    1.25377, 1.491657, 1.135661, 1.546082, 1.809583,
  0.3281778, 0.1120415, 0, 0.3292463, 0.30037, 0.5218721, 0.8890584, 
    1.112351, 1.4475, 1.000685, 0.8044971, 0.8433021, 1.089134, 1.071257, 
    1.245899, 1.150812, 1.24831, 1.224542, 1.421694, 1.67766,
  0.3121224, 0.2727991, 0.2097858, 0.3323447, 0.3909387, 0.6102133, 
    0.8392617, 1.164287, 1.081184, 0.7100733, 0.6169042, 0.7491233, 
    0.9381642, 0.8920908, 1.159725, 1.389825, 1.425675, 1.545485, 1.284541, 
    1.277788,
  0.2972597, 0.4807875, 0.4485662, 0.5076733, 0.490055, 0.794495, 0.8534787, 
    0.815887, 0.7883017, 0.5514959, 0.6536587, 0.7846617, 0.9697471, 
    0.7661712, 1.002248, 1.329586, 1.408211, 1.409519, 1.38548, 1.212135,
  0.3507985, 0.5728642, 0.6284388, 0.6629179, 0.6449867, 0.8559179, 
    0.9070663, 0.7153983, 0.5735238, 0.4788121, 0.4609046, 0.7031834, 
    0.6524088, 0.5711358, 0.7399254, 0.7449625, 0.9011288, 0.5818829, 
    0.777283, 1.169935,
  0.2794962, 0.4601629, 0.6814683, 0.5672342, 0.4687121, 0.4519862, 
    0.6705496, 0.6306046, 0.61085, 0.4824754, 0.5292513, 0.6378346, 
    0.4021487, 0.3603179, 0.3875297, 0.5279321, 0.6004892, 0.5406837, 
    0.5178558, 0.8921041,
  0.1696744, 0.4383379, 0.5835896, 0.7099192, 0.7235496, 0.4592917, 
    0.3673243, 0.3905784, 0.441905, 0.4808833, 0.5306875, 0.5290487, 
    0.6620716, 0.4650463, 0.3631501, 0.4065984, 0.4480675, 0.5630463, 
    0.8110588, 1.071086,
  0.2044038, 0.2955016, 0.5704042, 0.5342721, 0.5626058, 0.71681, 0.5128759, 
    0.4727858, 0.4752225, 0.413648, 0.3264885, 0.478175, 0.4767167, 
    0.4342133, 0.3906069, 0.3290222, 0.3493698, 0.3733296, 0.4806075, 
    0.7182083,
  0.1627499, 0.2422699, 0.2889635, 0.3241847, 0.2585987, 0.3989436, 
    0.3979709, 0.2799142, 0.2495352, 0.3631664, 0.386174, 0.3910215, 
    0.3887465, 0.4666979, 0.499645, 0.6052883, 0.6728995, 0.5399421, 
    0.7991254, 0.7282434 ;

 dataday = 2003001 ;

 lat = 37.625, 37.875, 38.125, 38.375, 38.625, 38.875, 39.125, 39.375, 
    39.625, 39.875, 40.125, 40.375, 40.625, 40.875, 41.125, 41.375 ;

 lon = -87.125, -86.875, -86.625, -86.375, -86.125, -85.875, -85.625, 
    -85.375, -85.125, -84.875, -84.625, -84.375, -84.125, -83.875, -83.625, 
    -83.375, -83.125, -82.875, -82.625, -82.375 ;

 time = 1041373800 ;
}
