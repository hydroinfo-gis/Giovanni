use strict;
use Test::More tests => 3;
use Giovanni::Testing;
use Giovanni::Data::NcFile;
use File::Temp;

# This tests to see if getUnitsArg.pl can handle units with white space.
my $dir = $ENV{SAVEDIR} || File::Temp::tempdir( CLEANUP => 1 );

# Find path for $program
my $program = 'getUnitsArg.pl';
my ($script_path) = Giovanni::Testing::find_script_paths($program);
ok( ( -e $script_path ), "Find script path for $program" );

# Write the manifest with destination units
my $data_info = <<'STR';
<manifest><data zValue="NA" units="mm/month">TRMM_3B43_7_precipitation</data></manifest>
STR

my $data_info_file = "$dir/manifest.xml";
open( FILE, ">", $data_info_file )
    or die "Unable to write $data_info_file";
print FILE $data_info;
close(FILE);

# Write the units configuration file
my $units_cfg = <<'STR';
<units>
    <linearConversions>
        <linearUnit add_offset="0" destination="mm/day"
            scale_factor="24" source="mm/hr"/>
        <linearUnit add_offset="0" destination="inch/hr"
            scale_factor="1.0/25.4" source="mm/hr"/>
        <linearUnit add_offset="0" destination="inch/day"
            scale_factor="24.0/25.4" source="mm/hr"/>
        <linearUnit add_offset="0" destination="mm/hr"
            scale_factor="1.0/24.0" source="mm/day"/>
        <linearUnit add_offset="0" destination="inch/day"
            scale_factor="1.0/25.4" source="mm/day"/>
        <linearUnit add_offset="0" destination="mm" scale_factor="1" source="kg/m^2"/>
        <linearUnit add_offset="-273.15" destination="C"
            scale_factor="1" source="K"/>
        <linearUnit add_offset="0" destination="mm/s" scale_factor="1" source="kg/m^2/s"/>
        <linearUnit add_offset="0" destination="mm/hr"
            scale_factor="3600" source="kg/m^2/s"/>
        <linearUnit add_offset="0" destination="DU"
            scale_factor="1.0/2.6868755e+16" source="molecules/cm^2"/>
        <linearUnit add_offset="0" destination="mm/month"
            scale_factor="1.0" source="kg/m^2"/>
        <linearUnit add_offset="0" destination="mm/day"
            scale_factor="86400" source="kg/m^2/s"/>
        <linearUnit add_offset="0" destination="mm/s" scale_factor="1" source="kg m-2 s-1"/>
        <linearUnit add_offset="0" destination="mm/hr"
            scale_factor="3600" source="kg m-2 s-1"/>
        <linearUnit add_offset="0" destination="mm/day"
            scale_factor="86400" source="kg m-2 s-1"/>
        <linearUnit add_offset="0" destination="mm/hr"
            scale_factor="1.0/3600.0" source="kg/m^2/s"/>
        <linearUnit add_offset="0" destination="kg m-2 s-1"
            scale_factor="1.0" source="kg/m^2/s"/>
        <linearUnit add_offset="0" destination="kg/m^2/s"
            scale_factor="1.0" source="kg m-2 s-1"/>                      
    </linearConversions>
    <nonLinearConversions>
        <timeDependentUnit
            class="Giovanni::UnitsConversion::MonthlyAccumulation"
            destination="mm/month" source="mm/hr"
            temporal_resolutions="monthly" to_days_scale_factor="24.0"/>
        <timeDependentUnit
            class="Giovanni::UnitsConversion::MonthlyAccumulation"
            destination="inch/month" source="mm/hr"
            temporal_resolutions="monthly" to_days_scale_factor="24.0/25.4"/>
        <timeDependentUnit
            class="Giovanni::UnitsConversion::MonthlyAccumulation"
            destination="mm/month" source="kg/m^2/s"
            temporal_resolutions="monthly" to_days_scale_factor="86400"/>
        <timeDependentUnit
            class="Giovanni::UnitsConversion::MonthlyAccumulation"
            destination="mm/month" source="mm/day"
            temporal_resolutions="monthly" to_days_scale_factor="1"/>
        <timeDependentUnit
            class="Giovanni::UnitsConversion::MonthlyAccumulation"
            destination="inch/month" source="mm/day"
            temporal_resolutions="monthly" to_days_scale_factor="1/25.4"/>
        <timeDependentUnit
            class="Giovanni::UnitsConversion::MonthlyAccumulation"
            destination="mm/month" source="kg m-2 s-1"
            temporal_resolutions="monthly" to_days_scale_factor="86400"/>
    </nonLinearConversions>
    <fileFriendlyStrings>
        <destinationUnit file="mmPday" original="mm/day"/>
        <destinationUnit file="inPhr" original="inch/hr"/>
        <destinationUnit file="inPday" original="inch/day"/>
        <destinationUnit file="mmPhr" original="mm/hr"/>
        <destinationUnit file="mm" original="mm"/>
        <destinationUnit file="mmPs" original="mm/s"/>
        <destinationUnit file="DU" original="DU"/>
        <destinationUnit file="mmPmon" original="mm/month"/>
        <destinationUnit file="inPmon" original="inch/month"/>
        <destinationUnit file="C" original="C"/>
        <destinationUnit file="kgSm-2Ss-1" original="kg m-2 s-1" />
        <destinationUnit file="kgPmmPs" original="kg/m^2/s" />
    </fileFriendlyStrings>
</units>
STR

my $units_cfg_file = "$dir/units.xml";
open( FILE, ">", $units_cfg_file ) or die "Unable to write $units_cfg_file";
print FILE $units_cfg;
close(FILE);

# write the data
my $cdls      = Giovanni::Data::NcFile::read_cdl_data_block();
my $data_file = "$dir/data.nc";
Giovanni::Data::NcFile::write_netcdf_file( $data_file, $cdls->[0] );

# write the result manifest file
my $result_manifest_str = << "MANIFEST";
<manifest>
 <fileList id="TRMM_3B43_7_precipitation">
  <file>
   $data_file
  </file>
 </fileList>
</manifest>
MANIFEST

my $result_manifest_file = "$dir/mfst.result.xml";
open( FILE, ">", $result_manifest_file )
    or die "Unable to write $result_manifest_file";
print FILE $result_manifest_str;
close(FILE);

my $cmd = "$script_path $data_info_file ALGORITHM,POST,WRAPPER "
    . "$units_cfg_file $result_manifest_file";

my @out = `$cmd`;

is( $?, 0, "Command returned zero." );

my $expected = qq(--units "mm/month,$units_cfg_file",WRAPPER);
is_deeply( \@out, [$expected], "Got the units option" );

__DATA__
netcdf data {
dimensions:
	time = UNLIMITED ; // (1 currently)
	lat = 40 ;
	lon = 40 ;
	latv = 2 ;
	lonv = 2 ;
	nv = 2 ;
variables:
	float TRMM_3B43_7_precipitation(time, lat, lon) ;
		TRMM_3B43_7_precipitation:_FillValue = -9999.9f ;
		TRMM_3B43_7_precipitation:long_name = "Precipitation Rate" ;
		TRMM_3B43_7_precipitation:product_short_name = "TRMM_3B43" ;
		TRMM_3B43_7_precipitation:product_version = "7" ;
		TRMM_3B43_7_precipitation:quantity_type = "Precipitation" ;
		TRMM_3B43_7_precipitation:standard_name = "precipitation" ;
		TRMM_3B43_7_precipitation:coordinates = "time lat lon" ;
		TRMM_3B43_7_precipitation:units = "mm/hr" ;
	int datamonth(time) ;
		datamonth:long_name = "Standardized Date Label" ;
	double lat(lat) ;
		lat:units = "degrees_north" ;
		lat:standard_name = "latitude" ;
		lat:bounds = "lat_bnds" ;
	double lat_bnds(lat, latv) ;
		lat_bnds:units = "degrees_north" ;
	float lon(lon) ;
		lon:units = "degrees_east" ;
		lon:standard_name = "longitude" ;
		lon:bounds = "lon_bnds" ;
	double lon_bnds(lon, lonv) ;
		lon_bnds:units = "degrees_east" ;
	int time(time) ;
		time:long_name = "time" ;
		time:standard_name = "time" ;
		time:units = "seconds since 1970-01-01 00:00:00" ;
		time:bounds = "time_bnds" ;
	int time_bnds(time, nv) ;
		time_bnds:units = "seconds since 1970-01-01 00:00:00" ;

// global attributes:
		:NCO = "\"4.5.3\"" ;
		:nco_openmp_thread_number = 1 ;
		:Conventions = "CF-1.4" ;
		:start_time = "2010-01-01T00:00:00Z" ;
		:end_time = "2010-01-31T23:59:59Z" ;
		:temporal_resolution = "monthly" ;
		:history = "Mon Jul 17 18:18:20 2017: ncks -d lat,-5.0,5.0 -d lon,-5.0,5.0 scrubbed.TRMM_3B43_7_precipitation.20100101.nc subset.nc" ;
data:

 TRMM_3B43_7_precipitation =
  0.001814516, 0.001129032, 0.00125, 0.001370968, 0.001491935, 0.005201612, 
    0.005282258, 0.006048386, 0.004395161, 0.002379032, 0.00266129, 
    0.002016129, 0.0009274193, 0.001653226, 0.0007258064, 0, 8.064516e-05, 
    0.0001612903, 0.0008467741, 0.00516129, 0.006653225, 0.007903226, 
    0.02137097, 0.03334677, 0.02104839, 0.01850807, 0.01649193, 0.01560484, 
    0.01141129, 0.01221774, 0.02193548, 0.03592742, 0.0266129, 0.03080645, 
    0.07096773, 0.1381855, 0.2295161, 0.3109677, 0.3757661, 0.5047581,
  0.001814516, 0.0009274193, 0.001290323, 0.00108871, 0.001169355, 
    0.007338709, 0.01016129, 0.006814515, 0.00358871, 0.003830645, 
    0.005443548, 0.003427419, 0.0008467741, 0.0005645161, 0.0005241935, 
    0.0002822581, 4.032258e-05, 0.0002016129, 0.0004435483, 0.003588709, 
    0.01060484, 0.01145161, 0.02919355, 0.04379033, 0.05520161, 0.02056451, 
    0.01528226, 0.02758064, 0.01693548, 0.01625, 0.0246371, 0.02318548, 
    0.02112903, 0.02306451, 0.05641129, 0.09274193, 0.1672581, 0.2078629, 
    0.3968951, 0.5406049,
  0.002983871, 0.001330645, 0.0006048387, 0.0006854839, 0.00233871, 
    0.003024193, 0.001854839, 0.004798387, 0.003709677, 0.006854838, 
    0.006653225, 0.004395161, 0.003024193, 0.00233871, 0.0003629032, 
    0.0006451613, 0.0002419355, 0.001814516, 0.002258064, 0.005201613, 
    0.007137096, 0.01354839, 0.03564516, 0.06439516, 0.0696371, 0.03177419, 
    0.03379032, 0.04383064, 0.02294355, 0.01975806, 0.03108871, 0.01612903, 
    0.02637096, 0.03508064, 0.07044355, 0.1158871, 0.1576613, 0.1686693, 
    0.2628629, 0.4300403,
  0.00141129, 0.001975806, 0.0006048387, 0.0007258065, 0.001169355, 
    0.0006854838, 0.002096774, 0.003064516, 0.005080645, 0.006008064, 
    0.005120968, 0.005080645, 0.004435483, 0.001733871, 0.001290323, 
    0.0009274192, 0.0008064515, 0.001733871, 0.0005645161, 0.004798387, 
    0.00983871, 0.01020161, 0.0232258, 0.05060484, 0.06693549, 0.06237903, 
    0.06076613, 0.07165322, 0.04641129, 0.04100807, 0.03612904, 0.02806451, 
    0.02762097, 0.04516128, 0.07008065, 0.03854838, 0.08620968, 0.1264516, 
    0.2542742, 0.3479033,
  0.02137097, 0.007177419, 0.005685484, 0.01052419, 0.004395161, 0.003709677, 
    0.009596774, 0.01193548, 0.01318548, 0.006975806, 0.00375, 0.00532258, 
    0.006048387, 0.005241935, 0.001975806, 0.004879032, 0.0009274193, 
    0.0002016129, 0.001209677, 0.006612903, 0.008064516, 0.01431452, 
    0.02205645, 0.04681451, 0.05657258, 0.06931452, 0.1093145, 0.07193548, 
    0.04754032, 0.02991935, 0.02701613, 0.02858871, 0.02915323, 0.0325, 
    0.03237903, 0.02532258, 0.05056452, 0.07076614, 0.1041935, 0.1432661,
  0.02241935, 0.008266129, 0.006854838, 0.01201613, 0.008951613, 0.005967742, 
    0.007782258, 0.01165323, 0.009395161, 0.005040322, 0.005846774, 
    0.006975806, 0.00516129, 0.005282258, 0.005120968, 0.007338709, 
    0.005645161, 0.005403226, 0.009193548, 0.02068548, 0.01616935, 
    0.02201613, 0.04048387, 0.05181452, 0.05915323, 0.06701612, 0.09366936, 
    0.07435484, 0.05612903, 0.05141129, 0.04112903, 0.04173386, 0.04508064, 
    0.03862903, 0.03802419, 0.03774193, 0.04854839, 0.05770161, 0.09044355, 
    0.09782259,
  0.02479839, 0.01358871, 0.01024193, 0.01778226, 0.01919355, 0.01282258, 
    0.007056451, 0.01129032, 0.0121371, 0.007338709, 0.00939516, 0.01092742, 
    0.009274193, 0.001814516, 0.00641129, 0.006612903, 0.006088709, 
    0.008225806, 0.01758065, 0.01850807, 0.02778226, 0.03846774, 0.06665323, 
    0.06052419, 0.05354838, 0.07375, 0.07592743, 0.0782258, 0.07923387, 
    0.07911291, 0.07754034, 0.06633064, 0.06145161, 0.05935484, 0.05314516, 
    0.03443548, 0.04314516, 0.09024193, 0.08068548, 0.1144758,
  0.03052419, 0.02754032, 0.02137097, 0.02475807, 0.01766129, 0.02068548, 
    0.01915323, 0.03572581, 0.009677419, 0.01120968, 0.01975806, 0.01076613, 
    0.02, 0.009193548, 0.007459677, 0.008145161, 0.008709677, 0.008629031, 
    0.01826613, 0.0225, 0.02762097, 0.04854839, 0.05939516, 0.08092742, 
    0.0525, 0.05806451, 0.06625, 0.06677419, 0.07750001, 0.08237903, 
    0.1009677, 0.1028629, 0.1382258, 0.1241532, 0.07358871, 0.06141129, 
    0.06189516, 0.09842742, 0.1028629, 0.09072582,
  0.03028226, 0.02629032, 0.03189516, 0.02717742, 0.02443548, 0.01685484, 
    0.01846774, 0.02774194, 0.01157258, 0.02028226, 0.01762097, 0.01471774, 
    0.007177419, 0.007419354, 0.007822581, 0.005806451, 0.009596773, 
    0.01282258, 0.02629032, 0.02943548, 0.02846774, 0.03290323, 0.05358871, 
    0.06314516, 0.05431452, 0.04387097, 0.0541129, 0.05185484, 0.0657258, 
    0.09705645, 0.1103629, 0.1321774, 0.1467339, 0.1272177, 0.1110081, 
    0.105121, 0.1314919, 0.1202419, 0.08891129, 0.05923387,
  0.04645161, 0.04092742, 0.03487903, 0.02475806, 0.02778226, 0.03758064, 
    0.03600806, 0.02475806, 0.01274193, 0.02197581, 0.01875, 0.01790322, 
    0.01366935, 0.02108871, 0.01842742, 0.01120968, 0.01084677, 0.025, 
    0.04141129, 0.0358871, 0.02415323, 0.02600807, 0.03834677, 0.04233871, 
    0.0457258, 0.04596774, 0.03701613, 0.04620967, 0.0475, 0.07850806, 
    0.1071371, 0.1146774, 0.1745161, 0.1327823, 0.156129, 0.1474193, 
    0.1259274, 0.08383064, 0.06278226, 0.05983871,
  0.03895162, 0.03895161, 0.03705645, 0.04108871, 0.04092741, 0.05717742, 
    0.04770161, 0.04060484, 0.03798387, 0.05822581, 0.05004033, 0.02451613, 
    0.01435484, 0.03120967, 0.02370968, 0.01653226, 0.007056451, 0.02237903, 
    0.03318548, 0.04322581, 0.02475807, 0.03879032, 0.03806451, 0.03391129, 
    0.03338709, 0.0425, 0.04, 0.04552419, 0.0508871, 0.06616935, 0.07681451, 
    0.07487904, 0.1053226, 0.09959678, 0.1258871, 0.1643145, 0.117379, 
    0.09786291, 0.1294758, 0.1310484,
  0.03572581, 0.02189516, 0.03100806, 0.07076613, 0.05754032, 0.03391128, 
    0.03887096, 0.05161291, 0.05403225, 0.06540322, 0.06931452, 0.03935484, 
    0.0207258, 0.02629032, 0.03532258, 0.03314516, 0.0228629, 0.02104839, 
    0.01927419, 0.04080645, 0.02725806, 0.04056452, 0.04112903, 0.03270161, 
    0.02758064, 0.03008064, 0.04306451, 0.06411291, 0.05870968, 0.04354838, 
    0.04193548, 0.05641129, 0.1354839, 0.1514516, 0.1585484, 0.1193548, 
    0.1331048, 0.1720968, 0.2647984, 0.3164113,
  0.03935484, 0.01375, 0.0353629, 0.06637096, 0.06181451, 0.03560484, 
    0.02810484, 0.0394758, 0.05415322, 0.06758064, 0.0630242, 0.06193549, 
    0.03395161, 0.04576613, 0.0578629, 0.04729838, 0.03693548, 0.02439516, 
    0.01778226, 0.02310484, 0.02358871, 0.02584678, 0.02633065, 0.02375, 
    0.02705645, 0.02725806, 0.04564516, 0.05020161, 0.04435483, 0.04431452, 
    0.07217741, 0.0796371, 0.2256048, 0.3258468, 0.311129, 0.2167742, 
    0.1672581, 0.2155645, 0.2995564, 0.3289517,
  0.0353629, 0.01629032, 0.06100807, 0.03758064, 0.05600806, 0.02370968, 
    0.02802419, 0.03205645, 0.04971774, 0.03233871, 0.04725806, 0.05870968, 
    0.04737904, 0.0428629, 0.04354839, 0.04072581, 0.03056451, 0.02298387, 
    0.01758065, 0.02447581, 0.01931452, 0.02935484, 0.02641129, 0.01887097, 
    0.01637097, 0.03955645, 0.03701613, 0.03693549, 0.05471775, 0.06528226, 
    0.09737903, 0.1523387, 0.2048387, 0.2071774, 0.1925403, 0.2665322, 
    0.4208871, 0.2806048, 0.3511291, 0.4843951,
  0.02004032, 0.04237903, 0.03935484, 0.01508064, 0.02024193, 0.03528226, 
    0.03217742, 0.03245968, 0.04048387, 0.04673386, 0.04165323, 0.05233871, 
    0.04137097, 0.02979838, 0.02455645, 0.03068548, 0.04197581, 0.02157258, 
    0.01612903, 0.02572581, 0.01846774, 0.0321371, 0.04411291, 0.04181452, 
    0.03427419, 0.04709677, 0.06584676, 0.04189516, 0.06552419, 0.07314517, 
    0.1199194, 0.1254032, 0.1600807, 0.2376209, 0.2058065, 0.2658871, 
    0.360121, 0.4841936, 0.5469757, 0.3900806,
  0.0203629, 0.02205645, 0.02169355, 0.01875, 0.01495968, 0.02245968, 
    0.02875, 0.03673387, 0.05443548, 0.07475806, 0.09685484, 0.09419354, 
    0.06092742, 0.0316129, 0.02838709, 0.02290322, 0.01879032, 0.01608871, 
    0.01326613, 0.02407258, 0.02725806, 0.02887097, 0.03564516, 0.05403226, 
    0.06677419, 0.0641129, 0.06633064, 0.05822581, 0.07116936, 0.07068547, 
    0.1070968, 0.1282661, 0.2435081, 0.3040725, 0.4239516, 0.3653225, 
    0.3914112, 0.5358467, 0.5260484, 0.3704032,
  0.01693548, 0.01983871, 0.01423387, 0.0141129, 0.01358871, 0.02193548, 
    0.03362903, 0.05512096, 0.1782258, 0.1976613, 0.187379, 0.1743951, 
    0.1444355, 0.07919355, 0.1276613, 0.06112904, 0.06443549, 0.03854838, 
    0.02072581, 0.05641129, 0.02802419, 0.04508064, 0.06282258, 0.1055242, 
    0.1075806, 0.1006048, 0.1133871, 0.1056855, 0.1283064, 0.09919354, 
    0.1169355, 0.1538306, 0.2859274, 0.3540322, 0.4419758, 0.3943145, 
    0.4943145, 0.6135082, 0.4956452, 0.4148791,
  0.03383065, 0.01633064, 0.02120968, 0.01947581, 0.01806452, 0.01866936, 
    0.02625, 0.06580645, 0.1703629, 0.1816129, 0.1310484, 0.1194758, 
    0.1099193, 0.130121, 0.1170161, 0.1141129, 0.04810484, 0.06423387, 
    0.03903225, 0.03193548, 0.02895161, 0.04625, 0.07584678, 0.1290323, 
    0.1274194, 0.09649194, 0.05705645, 0.0658871, 0.1335887, 0.1068145, 
    0.1158065, 0.1638306, 0.2774194, 0.3037098, 0.3592339, 0.3790725, 
    0.5036694, 0.6580644, 0.575524, 0.3566532,
  0.04939517, 0.03060484, 0.05616936, 0.06596775, 0.04342742, 0.03689516, 
    0.05495968, 0.04830645, 0.1106048, 0.1014113, 0.09306452, 0.1547984, 
    0.1560081, 0.08564516, 0.03620968, 0.06302419, 0.0566129, 0.06786291, 
    0.07020161, 0.08854838, 0.06637096, 0.04673387, 0.05725807, 0.1039516, 
    0.1273387, 0.06971774, 0.03274193, 0.04112903, 0.06612903, 0.07564516, 
    0.09556451, 0.1577016, 0.2935886, 0.327742, 0.3183064, 0.3905645, 
    0.3897178, 0.6875403, 0.6941128, 0.5749596,
  0.03959678, 0.04758065, 0.0596371, 0.04979839, 0.07004032, 0.06854838, 
    0.09282259, 0.08907259, 0.1762097, 0.1072581, 0.0973387, 0.1908468, 
    0.1943145, 0.1644355, 0.09508065, 0.1497984, 0.06911291, 0.09850807, 
    0.07846774, 0.1021774, 0.06677419, 0.05625, 0.06282258, 0.08608871, 
    0.05854838, 0.06096774, 0.05116935, 0.04495967, 0.0703629, 0.1279436, 
    0.1453629, 0.1308064, 0.1940726, 0.2185484, 0.2369355, 0.2550806, 
    0.2972177, 0.4935484, 0.7219356, 0.5387096,
  0.05870968, 0.08903225, 0.06834678, 0.09185483, 0.0905242, 0.08564515, 
    0.1057661, 0.09362905, 0.0742742, 0.0651613, 0.1100806, 0.1546371, 
    0.1479032, 0.1668548, 0.1542339, 0.1443952, 0.1156048, 0.09729838, 
    0.07125, 0.04209677, 0.03875, 0.04693548, 0.0516129, 0.08008064, 
    0.07149193, 0.0760887, 0.08245967, 0.1196774, 0.09995967, 0.1958064, 
    0.2297581, 0.2367339, 0.2312097, 0.2310887, 0.2319758, 0.2470564, 
    0.3326209, 0.3413306, 0.47, 0.5590323,
  0.1018145, 0.1103226, 0.1093952, 0.08806451, 0.1655645, 0.1269355, 
    0.1059274, 0.1022984, 0.1030645, 0.1272984, 0.1583871, 0.1425806, 
    0.1451613, 0.1702016, 0.1648387, 0.1833468, 0.1761694, 0.1719355, 
    0.1088306, 0.07612902, 0.05604839, 0.045, 0.03858871, 0.06540323, 
    0.07112903, 0.04870968, 0.05036291, 0.1369758, 0.1096774, 0.1790323, 
    0.1872984, 0.1468548, 0.1052823, 0.1317339, 0.1749193, 0.2525, 0.2666129, 
    0.2665726, 0.4394758, 0.5198387,
  0.08725807, 0.07524194, 0.1018145, 0.1194758, 0.2272581, 0.1977016, 
    0.1982661, 0.1912903, 0.1769355, 0.1716935, 0.237258, 0.3068145, 
    0.2834677, 0.2632661, 0.2202419, 0.2010484, 0.2289516, 0.2284274, 
    0.1750403, 0.1151613, 0.05754032, 0.07532258, 0.1002419, 0.09415323, 
    0.08987904, 0.09971774, 0.07705645, 0.08794355, 0.1691129, 0.1475, 
    0.08758065, 0.09314516, 0.1550806, 0.1954032, 0.3057258, 0.2214516, 
    0.1230242, 0.2002016, 0.2484677, 0.3074194,
  0.1545564, 0.1290726, 0.1041532, 0.1610887, 0.2816935, 0.2765322, 
    0.1992742, 0.2441532, 0.2815323, 0.2671371, 0.2541532, 0.3144758, 
    0.3401613, 0.3253629, 0.2640323, 0.2768548, 0.2282661, 0.2232661, 
    0.1293952, 0.1835887, 0.1195968, 0.1257258, 0.1230242, 0.1310081, 
    0.1629435, 0.1597581, 0.1694355, 0.1281048, 0.07314516, 0.07653226, 
    0.07358871, 0.09830644, 0.1710887, 0.2006452, 0.2025403, 0.1552822, 
    0.1157258, 0.118871, 0.1412903, 0.2010484,
  0.2658871, 0.2045161, 0.1705645, 0.2331451, 0.3100806, 0.242742, 0.2382258, 
    0.3123387, 0.2949193, 0.2807257, 0.2964516, 0.3116935, 0.329879, 
    0.3412097, 0.2341935, 0.2637903, 0.2204032, 0.2158064, 0.1680645, 
    0.2220161, 0.2482661, 0.2262903, 0.2114919, 0.1893952, 0.2370565, 
    0.2553226, 0.245121, 0.2097581, 0.1393952, 0.1031855, 0.1254032, 
    0.151371, 0.1710081, 0.2719354, 0.1484274, 0.1120968, 0.09096774, 
    0.09596774, 0.09379032, 0.1816129,
  0.17625, 0.1843952, 0.2130242, 0.2106048, 0.277258, 0.2702016, 0.267621, 
    0.3323387, 0.4082258, 0.2985887, 0.2721774, 0.2714516, 0.31625, 
    0.3196774, 0.2946371, 0.2675, 0.3061694, 0.3285484, 0.2570564, 0.2675403, 
    0.3306048, 0.3331451, 0.3135484, 0.2445968, 0.3060887, 0.2818548, 
    0.2824597, 0.3071774, 0.2379435, 0.17125, 0.1905645, 0.2268952, 
    0.3863709, 0.2950806, 0.1246371, 0.095, 0.05693549, 0.08717743, 
    0.1133871, 0.1591935,
  0.2097581, 0.2179839, 0.142258, 0.1793548, 0.273629, 0.2938307, 0.2850807, 
    0.2980241, 0.4317338, 0.2910887, 0.2935081, 0.2423387, 0.2774194, 
    0.2708871, 0.2497177, 0.2285887, 0.23875, 0.2554839, 0.297379, 0.2664113, 
    0.2590323, 0.279879, 0.2231452, 0.2483468, 0.2825001, 0.2890726, 
    0.2895564, 0.2865322, 0.3196774, 0.2972177, 0.2723387, 0.3476612, 
    0.3639516, 0.2588307, 0.1839113, 0.09903225, 0.07383063, 0.1249597, 
    0.1055242, 0.1383065,
  0.2419355, 0.2167742, 0.1664113, 0.1508871, 0.1767338, 0.2487096, 
    0.2492742, 0.2159677, 0.1806048, 0.21375, 0.258508, 0.2714112, 0.2712903, 
    0.2931854, 0.2730645, 0.2288307, 0.1894758, 0.1908871, 0.1720161, 
    0.2390726, 0.2181451, 0.2708064, 0.2723387, 0.3066936, 0.3063307, 
    0.2903226, 0.2368951, 0.2714516, 0.304879, 0.3625807, 0.3239113, 
    0.2489919, 0.1918145, 0.1362903, 0.0957258, 0.08584676, 0.09189516, 
    0.1520161, 0.133629, 0.1349193,
  0.2106855, 0.17125, 0.1410484, 0.1871371, 0.14, 0.1243952, 0.1841935, 
    0.09149194, 0.08673387, 0.1277016, 0.08883066, 0.1165323, 0.1452419, 
    0.2712904, 0.2556048, 0.3241935, 0.2188306, 0.2569355, 0.2519355, 
    0.2021774, 0.164879, 0.2193549, 0.1981452, 0.2572581, 0.3080242, 
    0.282379, 0.3085483, 0.3186693, 0.3088306, 0.2690323, 0.2938306, 
    0.3316129, 0.2089113, 0.1780242, 0.1765322, 0.122621, 0.09447581, 
    0.09923387, 0.1285484, 0.1710484,
  0.1277823, 0.1597984, 0.11125, 0.1273387, 0.1475, 0.1531048, 0.1687097, 
    0.1785887, 0.1968951, 0.1772177, 0.09858871, 0.07076612, 0.08665322, 
    0.1418145, 0.193629, 0.3610484, 0.3935081, 0.3018951, 0.3390725, 
    0.2030645, 0.1762097, 0.2264919, 0.1790323, 0.1742339, 0.1693549, 
    0.1735887, 0.1487903, 0.1681855, 0.1375, 0.0866129, 0.1921774, 0.218508, 
    0.1112903, 0.09350806, 0.1249193, 0.1321774, 0.1097581, 0.1016532, 
    0.1294355, 0.1978629,
  0.1316935, 0.1865726, 0.1395161, 0.1456048, 0.1728226, 0.135121, 0.1090726, 
    0.1229436, 0.1464113, 0.1327823, 0.09157258, 0.06669355, 0.07826613, 
    0.09689515, 0.2365726, 0.3133065, 0.3459677, 0.3083871, 0.2456855, 
    0.263629, 0.2319758, 0.2304436, 0.2419355, 0.1449194, 0.1087903, 
    0.07451613, 0.05415322, 0.07294355, 0.07153225, 0.1034677, 0.1328629, 
    0.116371, 0.07294355, 0.0853629, 0.1153629, 0.1249194, 0.1223387, 
    0.1021774, 0.1135484, 0.1629032,
  0.1894355, 0.1984274, 0.1830645, 0.1481855, 0.1389113, 0.1237097, 
    0.08721775, 0.1162097, 0.1391935, 0.1032661, 0.08213709, 0.09298388, 
    0.08673386, 0.1384274, 0.1720161, 0.2420565, 0.2005242, 0.2358871, 
    0.2200403, 0.2036694, 0.1998387, 0.2334274, 0.2266532, 0.2345161, 
    0.2002016, 0.1080645, 0.04657258, 0.06637096, 0.07060483, 0.1014516, 
    0.09092741, 0.07334678, 0.07915323, 0.1193548, 0.1041532, 0.09137097, 
    0.08939516, 0.08874999, 0.1095564, 0.1171371,
  0.2221774, 0.2399193, 0.2597984, 0.1578226, 0.1182661, 0.1461693, 
    0.1054032, 0.06064517, 0.08258065, 0.07657257, 0.05080645, 0.06907257, 
    0.07173388, 0.08286289, 0.08379032, 0.07512096, 0.1463307, 0.1746774, 
    0.1754032, 0.194879, 0.1815726, 0.217379, 0.2493548, 0.3209678, 
    0.2500404, 0.1614516, 0.1100807, 0.120121, 0.08685484, 0.07193548, 
    0.08141129, 0.06560484, 0.09870967, 0.1325, 0.08310484, 0.06120968, 
    0.03068548, 0.08294355, 0.09838709, 0.1670564,
  0.1544758, 0.1695565, 0.1436694, 0.1039516, 0.09004032, 0.1241532, 
    0.1814919, 0.06899193, 0.09080645, 0.08290322, 0.04758064, 0.06995967, 
    0.1070161, 0.0448387, 0.06104838, 0.07504033, 0.06088709, 0.0941129, 
    0.09903226, 0.1271774, 0.1568145, 0.2005242, 0.1914516, 0.1511694, 
    0.1880645, 0.1729436, 0.1034677, 0.1097581, 0.09040323, 0.07774194, 
    0.08096775, 0.1041532, 0.07608871, 0.1146774, 0.08653225, 0.08580644, 
    0.05625, 0.0801613, 0.1197984, 0.237379,
  0.07810483, 0.08395161, 0.05866935, 0.05072581, 0.09048387, 0.1382661, 
    0.1349597, 0.108629, 0.1018548, 0.1147177, 0.06778225, 0.1639517, 
    0.2194355, 0.1502016, 0.1536693, 0.1064516, 0.05637097, 0.05495968, 
    0.05838709, 0.06169355, 0.1268952, 0.2362097, 0.2098387, 0.1070968, 
    0.1335887, 0.1477823, 0.1184274, 0.1767742, 0.121371, 0.07866935, 
    0.1006048, 0.07177419, 0.106129, 0.1509274, 0.09911291, 0.09612903, 
    0.1190323, 0.2107258, 0.1895161, 0.1147984,
  0.1290726, 0.06794355, 0.04282258, 0.05, 0.18, 0.1816936, 0.1089516, 
    0.1197984, 0.1004435, 0.07516129, 0.0646371, 0.1665726, 0.2153629, 
    0.1870968, 0.1394758, 0.08584679, 0.04657258, 0.05112903, 0.03790322, 
    0.05858872, 0.1352016, 0.2018548, 0.2137903, 0.1170565, 0.1056048, 
    0.09112904, 0.08794355, 0.1364919, 0.1015323, 0.08717743, 0.09903225, 
    0.08443549, 0.08576613, 0.06366935, 0.1023387, 0.075, 0.1046774, 
    0.2623387, 0.2017339, 0.08528225,
  0.1269758, 0.07762098, 0.162621, 0.1285081, 0.1393952, 0.1103226, 
    0.07935484, 0.09282258, 0.06061493, 0.05734393, 0.04809256, 0.1092625, 
    0.09850053, 0.07280391, 0.05775001, 0.05454996, 0.04532257, 0.04149194, 
    0.02649193, 0.03169355, 0.1048387, 0.1031452, 0.1536693, 0.06479838, 
    0.04822581, 0.05024194, 0.04862903, 0.0633871, 0.07209678, 0.05137097, 
    0.04600807, 0.04129032, 0.04616936, 0.05040323, 0.05899193, 0.05262097, 
    0.03935484, 0.05362903, 0.06334677, 0.02971774,
  0.1006855, 0.07052419, 0.1380242, 0.1433871, 0.09379032, 0.06548387, 
    0.05572581, 0.06149194, 0.06083534, 0.0679657, 0.04751113, 0.07986708, 
    0.06379799, 0.05765425, 0.05402898, 0.0562102, 0.04979839, 0.03741935, 
    0.03713709, 0.04205645, 0.05830645, 0.05879032, 0.0666129, 0.02875, 
    0.04455645, 0.02790322, 0.03395161, 0.0494758, 0.06596775, 0.03866935, 
    0.04834678, 0.04334678, 0.06120967, 0.07334678, 0.09245967, 0.09032258, 
    0.02955645, 0.01866935, 0.01770161, 0.02532258,
  0.1402822, 0.1366129, 0.05169354, 0.0848387, 0.1451613, 0.1185887, 
    0.09612904, 0.02777165, 0.04372973, 0.04613935, 0.03962586, 0.0445306, 
    0.03702272, 0.04281668, 0.04496193, 0.04356567, 0.05169355, 0.05504032, 
    0.04979839, 0.04741935, 0.06358871, 0.06149193, 0.03471773, 0.0241129, 
    0.02705645, 0.03419355, 0.0321371, 0.04641129, 0.03572581, 0.03693548, 
    0.05391129, 0.0625, 0.07971775, 0.07975806, 0.07540323, 0.08705645, 
    0.02209677, 0.009717741, 0.01637097, 0.01616936,
  0.08908324, 0.0486572, 0.04224112, 0.04245786, 0.04120786, 0.03219538, 
    0.03982099, 0.0514437, 0.05115551, 0.04383579, 0.0428566, 0.0330959, 
    0.03311216, 0.03026975, 0.03063205, 0.02527, 0.02319453, 0.04995967, 
    0.03709677, 0.02810484, 0.04366935, 0.03330645, 0.02919355, 0.02387097, 
    0.03520161, 0.02737903, 0.03504033, 0.04915323, 0.06237903, 0.04850806, 
    0.04596774, 0.0923387, 0.1009677, 0.06604838, 0.04653226, 0.02375, 
    0.01508064, 0.01770161, 0.02205645, 0.03818548 ;

 datamonth = 201001 ;

 lat = -4.875, -4.625, -4.375, -4.125, -3.875, -3.625, -3.375, -3.125, 
    -2.875, -2.625, -2.375, -2.125, -1.875, -1.625, -1.375, -1.125, -0.875, 
    -0.625, -0.375, -0.125, 0.125, 0.375, 0.625, 0.875, 1.125, 1.375, 1.625, 
    1.875, 2.125, 2.375, 2.625, 2.875, 3.125, 3.375, 3.625, 3.875, 4.125, 
    4.375, 4.625, 4.875 ;

 lat_bnds =
  -5, -4.75,
  -4.75, -4.5,
  -4.5, -4.25,
  -4.25, -4,
  -4, -3.75,
  -3.75, -3.5,
  -3.5, -3.25,
  -3.25, -3,
  -3, -2.75,
  -2.75, -2.5,
  -2.5, -2.25,
  -2.25, -2,
  -2, -1.75,
  -1.75, -1.5,
  -1.5, -1.25,
  -1.25, -1,
  -1, -0.75,
  -0.75, -0.5,
  -0.5, -0.25,
  -0.25, 0,
  0, 0.25,
  0.25, 0.5,
  0.5, 0.75,
  0.75, 1,
  1, 1.25,
  1.25, 1.5,
  1.5, 1.75,
  1.75, 2,
  2, 2.25,
  2.25, 2.5,
  2.5, 2.75,
  2.75, 3,
  3, 3.25,
  3.25, 3.5,
  3.5, 3.75,
  3.75, 4,
  4, 4.25,
  4.25, 4.5,
  4.5, 4.75,
  4.75, 5 ;

 lon = -4.875, -4.625, -4.375, -4.125, -3.875, -3.625, -3.375, -3.125, 
    -2.875, -2.625, -2.375, -2.125, -1.875, -1.625, -1.375, -1.125, -0.875, 
    -0.625, -0.375, -0.125, 0.125, 0.375, 0.625, 0.875, 1.125, 1.375, 1.625, 
    1.875, 2.125, 2.375, 2.625, 2.875, 3.125, 3.375, 3.625, 3.875, 4.125, 
    4.375, 4.625, 4.875 ;

 lon_bnds =
  -5, -4.75,
  -4.75, -4.5,
  -4.5, -4.25,
  -4.25, -4,
  -4, -3.75,
  -3.75, -3.5,
  -3.5, -3.25,
  -3.25, -3,
  -3, -2.75,
  -2.75, -2.5,
  -2.5, -2.25,
  -2.25, -2,
  -2, -1.75,
  -1.75, -1.5,
  -1.5, -1.25,
  -1.25, -1,
  -1, -0.75,
  -0.75, -0.5,
  -0.5, -0.25,
  -0.25, 0,
  0, 0.25,
  0.25, 0.5,
  0.5, 0.75,
  0.75, 1,
  1, 1.25,
  1.25, 1.5,
  1.5, 1.75,
  1.75, 2,
  2, 2.25,
  2.25, 2.5,
  2.5, 2.75,
  2.75, 3,
  3, 3.25,
  3.25, 3.5,
  3.5, 3.75,
  3.75, 4,
  4, 4.25,
  4.25, 4.5,
  4.5, 4.75,
  4.75, 5 ;

 time = 1262304000 ;

 time_bnds =
  1262304000, 1264982399 ;
}
