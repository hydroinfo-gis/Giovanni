use strict;
use Test::More tests => 5;
use Giovanni::Data::NcFile;
use Giovanni::Testing;
use Cwd qw(abs_path);
use File::Temp qw(tempdir);
use File::Basename;

# Find path for $program
my $program = 'g4_curtain_lat.pl';
my ($script_path) = Giovanni::Testing::find_script_paths($program);
ok( ( -e $script_path ), "Find script path for $program" )
    or die "No point going further";

$script_path = abs_path($script_path);

# create a temporary directory
my $tempDir = tempdir( CLEANUP => 1 );

# read in the cdl
my $cdl = Giovanni::Data::NcFile::read_cdl_data_block();

# write the correct output to the temporary directory
my $correctOutFile = "$tempDir/correct.nc";
Giovanni::Data::NcFile::write_netcdf_file( $correctOutFile, $cdl->[0] );

# find the scrubbed input file
# NOTE: The CDL for this file is extremely large because it is a 3D file.
# Putting all of that in the data section would be very unwieldy. So I've
# just checked it into our repository as a binary file.
my $testDir = dirname( abs_path($0) );
my $inFile  = "$testDir/scrubbed.MAI3CPASM_5_2_0_T.200401010000.nc";
ok( ( -e $inFile ), "Find input scrubbed file" )
    or die "Unable to find input file. Expected it to be $inFile";

# create a text file with the input file
my $inTxt = "$tempDir/in.txt";
open( FILE, ">", $inTxt ) or die "Unable to write $inTxt.";
print FILE "$inFile\n";
close(FILE);

# This code produces a bunch of intermediate files. Changing into the
# temporary directory will ensure these files get cleaned up.
my $currDir = abs_path(".");
chdir($tempDir);

my $bbox       = '-99.8437,-6.2109,-6.3281,41.6016';
my $start_time = '2004-01-01T00:00:00Z';
my $end_time   = '2004-01-01T02:59:59Z';
my $variable   = 'MAI3CPASM_5_2_0_T';

my $outFile = "$tempDir/out.nc";

my @cmd = (
    $script_path, "-b", $bbox,     "-s", $start_time, "-e",
    $end_time,    "-v", $variable, "-f", $inTxt,      "-o",
    $outFile
);

my $ret = system(@cmd);

chdir($currDir);

is( $ret, 0, "Command returned zero: $ret" );
ok( -f $outFile, "Output file created" );

my $diff
    = Giovanni::Data::NcFile::diff_netcdf_files( $outFile, $correctOutFile,
    "/title" );

is( $diff, "", "Files are the same: $diff" );

__DATA__
netcdf g4.curtainLatitude.MAI3CPASM_5_2_0_T.20040101-20040101.99W_6S_6W_41N {
dimensions:
	Height = 42 ;
	lat = 38 ;
	latv = 2 ;
	lonv = 2 ;
variables:
	double Height(Height) ;
		Height:long_name = "vertical level" ;
		Height:positive = "down" ;
		Height:coordinate = "PLE" ;
		Height:standard_name = "PLE_level" ;
		Height:formula_term = "unknown" ;
		Height:fullpath = "Height:EOSGRID" ;
		Height:units = "hPa" ;
	float MAI3CPASM_5_2_0_T(Height, lat) ;
		MAI3CPASM_5_2_0_T:_FillValue = 1.e+15f ;
		MAI3CPASM_5_2_0_T:missing_value = 1.e+15f ;
		MAI3CPASM_5_2_0_T:fmissing_value = 1.e+15f ;
		MAI3CPASM_5_2_0_T:vmin = -1.e+30f ;
		MAI3CPASM_5_2_0_T:vmax = 1.e+30f ;
		MAI3CPASM_5_2_0_T:fullpath = "/EOSGRID/Data Fields/T" ;
		MAI3CPASM_5_2_0_T:standard_name = "air_temperature" ;
		MAI3CPASM_5_2_0_T:quantity_type = "Air Temperature" ;
		MAI3CPASM_5_2_0_T:product_short_name = "MAI3CPASM" ;
		MAI3CPASM_5_2_0_T:product_version = "5.2.0" ;
		MAI3CPASM_5_2_0_T:long_name = "Air Temperature, Instantaneous" ;
		MAI3CPASM_5_2_0_T:units = "K" ;
		MAI3CPASM_5_2_0_T:cell_methods = " time: point time: mean lon: mean" ;
		MAI3CPASM_5_2_0_T:coordinates = "Height lat " ;
	double lat(lat) ;
		lat:units = "degrees_north" ;
		lat:fullpath = "YDim:EOSGRID" ;
		lat:standard_name = "latitude" ;
		lat:bounds = "lat_bnds" ;
	double lat_bnds(lat, latv) ;
		lat_bnds:units = "degrees_north" ;
	double lon ;
		lon:units = "degrees_east" ;
		lon:fullpath = "XDim:EOSGRID" ;
		lon:standard_name = "longitude" ;
		lon:bounds = "lon_bnds" ;
		lon:cell_methods = "lon: mean" ;
	double lon_bnds(lonv) ;
		lon_bnds:units = "degrees_east" ;
		lon_bnds:cell_methods = "lon: mean" ;

// global attributes:
		:Conventions = "CF-1.4" ;
		:NCO = "\"4.5.3\"" ;
		:nco_openmp_thread_number = 1 ;
		:history = "Wed Nov  2 17:35:44 2016: ncatted -a valid_range,,d,, -O -o curtainLatitude.MAI3CPASM_5_2_0_T.20040101-20040101.99W_6S_6W_41N.nc curtainLatitude.MAI3CPASM_5_2_0_T.20040101-20040101.99W_6S_6W_41N.nc\n",
			"Wed Nov  2 17:35:44 2016: ncks -O -d lat,-6.2109,41.6016 -d lon,-99.8437,-6.3281 curtainLatitude.MAI3CPASM_5_2_0_T.20040101-20040101.99W_6S_6W_41N.nc curtainLatitude.MAI3CPASM_5_2_0_T.20040101-20040101.99W_6S_6W_41N.nc.subset\n",
			"Wed Nov  2 17:35:44 2016: ncatted -O -a title,global,o,c,MAI3CPASM_5_2_0_T Averaged over 2004-01-01 to 2004-01-01 curtainLatitude.MAI3CPASM_5_2_0_T.20040101-20040101.99W_6S_6W_41N.nc\n",
			"Wed Nov  2 17:35:44 2016: ncks -x -v time -o curtainLatitude.MAI3CPASM_5_2_0_T.20040101-20040101.99W_6S_6W_41N.nc -O curtainLatitude.MAI3CPASM_5_2_0_T.20040101-20040101.99W_6S_6W_41N.nc\n",
			"Wed Nov  2 17:35:44 2016: ncwa -o curtainLatitude.MAI3CPASM_5_2_0_T.20040101-20040101.99W_6S_6W_41N.nc -a time -O curtainLatitude.MAI3CPASM_5_2_0_T.20040101-20040101.99W_6S_6W_41N.nc\n",
			"Wed Nov  2 17:35:44 2016: ncra -D 2 -H -O -o curtainLatitude.MAI3CPASM_5_2_0_T.20040101-20040101.99W_6S_6W_41N.nc -d lat,-6.210900,41.601600 -d lon,-99.843700,-6.328100" ;
		:end_time = "2004-01-01T00:00:00Z" ;
		:start_time = "2004-01-01T00:00:00Z" ;
		:title = "Cross Section, Latitude-Pressure of Air Temperature, Instantaneous 3-hourly 1.25 deg. [MERRA Model MAI3CPASM v5.2.0] K over 2004-01-01 00Z - 2004-01-01 00:00:00Z, Region 99.8437W, 6.2109S, 6.3281W, 41.6016N" ;
data:

 Height = 1000, 975, 950, 925, 900, 875, 850, 825, 800, 775, 750, 725, 700, 
    650, 600, 550, 500, 450, 400, 350, 300, 250, 200, 150, 100, 70, 50, 40, 
    30, 20, 10, 7, 5, 4, 3, 2, 1, 0.699999988079071, 0.5, 0.400000005960464, 
    0.300000011920929, 0.100000001490116 ;

 MAI3CPASM_5_2_0_T =
  297.6005, 297.9721, 298.3893, 298.4001, 298.5001, 298.6102, 298.6821, 
    299.1161, 299.3075, 299.4276, 299.5327, 299.0854, 298.7899, 298.5074, 
    298.3174, 298.1764, 297.8326, 297.4378, 296.9103, 296.4417, 295.8516, 
    295.3196, 294.6816, 294.1144, 293.5851, 293.1655, 292.6743, 291.9875, 
    291.1621, 290.3514, 289.3475, 288.6768, 288.2045, 287.7586, 286.985, 
    286.3002, 285.5836, 285.0744,
  297.1767, 297.106, 296.968, 296.8937, 296.8388, 296.7288, 296.5583, 
    296.8972, 297.0833, 297.4753, 297.5847, 297.2211, 296.8965, 296.5232, 
    296.4589, 296.5904, 296.1704, 295.8221, 295.1203, 294.5528, 293.9638, 
    293.4043, 292.7191, 292.1228, 291.5071, 291.0658, 290.6432, 290.1168, 
    289.2473, 288.3705, 287.3584, 286.7248, 286.1235, 285.6472, 285.0027, 
    284.3068, 283.2172, 281.9242,
  295.814, 295.5836, 295.3336, 295.2274, 295.2442, 295.2356, 295.232, 
    295.2868, 295.3815, 295.6691, 295.808, 295.551, 295.2935, 294.9876, 
    295.0275, 295.0866, 294.5667, 294.1201, 293.3908, 292.8926, 292.2355, 
    291.7724, 291.0879, 290.4337, 289.7545, 289.2724, 288.7868, 288.4085, 
    287.62, 286.5638, 285.5207, 284.8104, 284.3035, 283.8989, 283.4244, 
    282.7007, 281.7341, 280.537,
  294.2161, 294.0066, 293.8118, 293.7694, 293.8842, 294.0203, 294.2487, 
    294.318, 294.3086, 294.1711, 294.2031, 294.0299, 293.8118, 293.524, 
    293.5414, 293.5026, 292.8848, 292.3593, 291.6058, 291.0373, 290.3637, 
    289.873, 289.2341, 288.5624, 287.9153, 287.452, 287.0222, 286.8607, 
    286.3159, 285.3745, 284.2062, 283.3205, 282.8332, 282.6184, 282.1369, 
    281.4855, 280.6924, 279.7383,
  292.7017, 292.6598, 292.6409, 292.7514, 292.8032, 292.9727, 292.9864, 
    293.0885, 293.1416, 293.0226, 292.7148, 292.5339, 292.5961, 292.4583, 
    292.4013, 292.3046, 291.7338, 291.072, 290.1201, 289.33, 288.5989, 
    287.9982, 287.4688, 287.059, 286.724, 286.374, 285.9252, 285.5561, 
    285.2565, 284.7435, 283.8218, 282.9831, 282.4334, 282.0156, 281.3797, 
    280.6628, 279.6861, 278.8584,
  291.5999, 291.5733, 291.5725, 291.8075, 291.8204, 291.757, 291.7334, 
    291.8507, 291.9545, 291.9465, 291.8424, 291.9338, 292.0359, 291.8404, 
    291.4646, 291.18, 290.7446, 290.1781, 289.1782, 288.3242, 287.3997, 
    286.7531, 286.4198, 286.2373, 285.8023, 285.6473, 285.3329, 284.8857, 
    284.7436, 284.4578, 283.9623, 283.2223, 282.5097, 281.8525, 281.0381, 
    280.0399, 279.0393, 278.2128,
  290.6472, 290.6508, 290.6832, 290.7231, 290.6276, 290.5436, 290.5482, 
    290.6078, 290.7307, 290.7278, 290.7942, 290.9043, 291.0285, 290.7939, 
    290.4127, 290.0406, 289.5777, 288.9899, 288.1464, 287.5691, 286.9914, 
    286.5124, 286.0883, 285.6181, 285.3331, 285.1064, 284.7806, 284.4656, 
    284.2783, 283.9367, 283.3783, 283.1622, 282.64, 282.0245, 281.0845, 
    279.9429, 278.7045, 277.7037,
  289.7996, 289.7362, 289.6779, 289.6167, 289.4212, 289.2932, 289.2852, 
    289.2937, 289.4037, 289.5074, 289.4781, 289.5299, 289.6479, 289.4845, 
    289.2249, 288.887, 288.3187, 287.7729, 287.138, 286.7436, 286.3832, 
    286.247, 285.9801, 285.4968, 284.9489, 284.6104, 284.2226, 283.7155, 
    283.4055, 283.0826, 282.7187, 282.5766, 282.0983, 281.462, 280.6214, 
    279.6348, 278.2426, 277.0557,
  288.7381, 288.6239, 288.5559, 288.417, 288.1721, 288.0247, 287.9816, 
    287.9706, 288.1181, 288.1885, 288.1404, 288.2081, 288.2456, 288.1433, 
    287.931, 287.7402, 287.2327, 286.6969, 286.17, 285.9356, 285.7413, 
    285.7624, 285.5394, 285.051, 284.5387, 284.0648, 283.5946, 282.99, 
    282.4379, 282.1646, 281.9527, 281.6575, 281.0506, 280.4475, 279.7664, 
    278.9792, 277.5596, 276.146,
  287.4845, 287.3362, 287.2762, 287.0587, 286.8197, 286.7018, 286.6437, 
    286.6166, 286.6666, 286.7268, 286.7052, 286.8108, 286.8029, 286.7271, 
    286.61, 286.5029, 286.1683, 285.7858, 285.3566, 285.192, 285.0681, 
    284.9758, 284.7539, 284.2702, 283.7375, 283.2104, 282.6347, 282.0562, 
    281.4102, 281.1929, 281.091, 280.6187, 279.8808, 279.3202, 278.7181, 
    278.0252, 276.6787, 275.1272,
  286.116, 285.9631, 285.8839, 285.6784, 285.4817, 285.3394, 285.2685, 
    285.2364, 285.2364, 285.2702, 285.1881, 285.3135, 285.3181, 285.2835, 
    285.226, 285.1277, 284.9906, 284.801, 284.5143, 284.2343, 284.0452, 
    283.8387, 283.4712, 283.0068, 282.5143, 282.0252, 281.4514, 280.9091, 
    280.2139, 280.0177, 279.902, 279.3566, 278.6696, 278.1997, 277.5747, 
    276.8101, 275.5002, 273.9103,
  284.6707, 284.5523, 284.4432, 284.2198, 284.0778, 283.9682, 283.8802, 
    283.8003, 283.7757, 283.7523, 283.6615, 283.7761, 283.8132, 283.8452, 
    283.779, 283.6832, 283.6419, 283.4169, 283.1732, 282.909, 282.6869, 
    282.3836, 281.9902, 281.5482, 281.0723, 280.5975, 280.1176, 279.6734, 
    279.0119, 278.7861, 278.474, 277.8886, 277.3865, 276.9621, 276.3048, 
    275.4198, 274.1292, 272.5945,
  283.2164, 283.1047, 282.9447, 282.7472, 282.5576, 282.4464, 282.3993, 
    282.3152, 282.2643, 282.1781, 282.1639, 282.2122, 282.2145, 282.2306, 
    282.1191, 282.0622, 282.1964, 281.9597, 281.6824, 281.3804, 281.0829, 
    280.7206, 280.3004, 279.8658, 279.3835, 278.9645, 278.5402, 278.1352, 
    277.7808, 277.5122, 276.9249, 276.3506, 275.933, 275.5037, 274.8373, 
    273.8989, 272.6443, 271.1806,
  280.2101, 280.0917, 279.9076, 279.8159, 279.6721, 279.5721, 279.455, 
    279.4321, 279.428, 279.4559, 279.498, 279.3726, 279.2092, 279.0547, 
    278.9021, 278.8896, 278.9607, 278.8575, 278.4499, 277.9463, 277.3907, 
    276.9436, 276.573, 276.1617, 275.6603, 275.2567, 274.9278, 274.5761, 
    274.304, 274.0726, 273.6326, 273.0852, 272.5023, 271.9657, 271.2809, 
    270.4866, 269.4592, 268.187,
  277.0073, 277.0335, 277.0348, 277.1206, 277.1115, 277.0065, 276.9165, 
    276.9277, 276.8802, 276.7198, 276.5602, 276.3781, 276.1465, 275.9473, 
    275.8023, 275.6673, 275.3744, 275.1483, 274.6413, 274.0883, 273.4667, 
    272.9327, 272.446, 272.0554, 271.6342, 271.3046, 270.9054, 270.5052, 
    270.2054, 269.9523, 269.6171, 269.133, 268.4202, 267.7675, 267.0824, 
    266.469, 265.7816, 264.8645,
  273.0412, 273.1066, 273.3503, 273.6082, 273.7537, 273.8932, 273.9358, 
    273.8758, 273.6803, 273.4499, 273.267, 273.1949, 273.0258, 272.7041, 
    272.2416, 271.8476, 271.3764, 270.9599, 270.3739, 269.7534, 269.0989, 
    268.6189, 268.1274, 267.7312, 267.2753, 266.8778, 266.3914, 265.9989, 
    265.7105, 265.446, 265.028, 264.5528, 263.8568, 263.252, 262.6517, 
    262.1346, 261.5676, 260.8939,
  268.6101, 268.7105, 268.9151, 268.9526, 268.9451, 269.0564, 269.1222, 
    269.0455, 268.9068, 268.8614, 268.7247, 268.5014, 268.2447, 267.9093, 
    267.5351, 267.0793, 266.641, 266.2226, 265.7672, 265.2005, 264.4518, 
    263.8091, 263.2451, 262.9154, 262.48, 261.8853, 261.3062, 260.9334, 
    260.581, 260.2197, 259.7651, 259.3875, 258.9031, 258.3595, 257.865, 
    257.4147, 256.8678, 256.3555,
  264.3157, 264.3607, 264.3511, 264.2303, 264.1316, 263.9957, 263.9245, 
    263.7657, 263.5799, 263.5695, 263.4239, 263.2024, 263.0153, 262.7826, 
    262.3126, 261.9478, 261.6591, 261.1276, 260.5176, 259.9859, 259.2801, 
    258.5901, 257.8321, 257.2652, 256.7968, 256.2583, 255.6743, 255.2469, 
    254.8289, 254.3303, 253.9046, 253.6353, 253.3115, 252.8186, 252.3436, 
    251.9859, 251.5717, 251.1895,
  258.3347, 258.4018, 258.4237, 258.4235, 258.442, 258.3526, 258.2856, 
    258.1843, 258.0368, 257.8049, 257.7362, 257.7024, 257.6039, 257.4214, 
    257.021, 256.4443, 255.851, 255.4364, 254.7574, 254.1074, 253.3795, 
    252.6118, 251.819, 251.0248, 250.2994, 249.753, 249.2209, 248.7718, 
    248.3147, 247.8408, 247.5412, 247.2511, 246.9983, 246.5818, 246.0124, 
    245.5969, 245.2031, 244.9194,
  250.935, 251.0486, 251.1092, 251.1821, 251.4113, 251.4629, 251.2829, 
    251.1998, 251.1523, 250.9717, 250.7125, 250.585, 250.5202, 250.4754, 
    250.2692, 249.7846, 249.0117, 248.5108, 247.9442, 247.3148, 246.591, 
    245.7489, 244.8983, 244.125, 243.2382, 242.5929, 242.0286, 241.5964, 
    241.1012, 240.6323, 240.2699, 240.0061, 239.7358, 239.3866, 238.8832, 
    238.3567, 237.9116, 237.5921,
  242.2927, 242.43, 242.4421, 242.4671, 242.5748, 242.5623, 242.5369, 
    242.4756, 242.3, 242.1546, 242.0296, 241.8389, 241.5287, 241.2569, 
    241.13, 240.9619, 240.6721, 240.2544, 239.7817, 239.2762, 238.5633, 
    237.8204, 236.9005, 236.0632, 235.2243, 234.5578, 233.968, 233.4241, 
    232.9035, 232.5582, 232.1069, 231.7836, 231.5038, 231.2419, 230.8991, 
    230.4207, 229.8841, 229.5851,
  232.3077, 232.3768, 232.3694, 232.3614, 232.3221, 232.2935, 232.155, 
    232.1064, 231.9948, 231.8773, 231.7277, 231.5416, 231.3174, 231.0471, 
    230.7488, 230.5626, 230.4711, 230.3165, 230.0396, 229.6415, 229.1574, 
    228.6563, 227.9299, 227.2097, 226.4047, 225.6951, 224.9904, 224.4831, 
    224.0049, 223.6357, 223.1876, 222.8449, 222.521, 222.3078, 222.0566, 
    221.7885, 221.4819, 221.3713,
  219.7785, 219.7977, 219.8026, 219.6775, 219.5004, 219.5121, 219.5049, 
    219.4271, 219.3529, 219.2905, 219.2569, 219.1191, 218.8988, 218.8197, 
    218.8154, 218.7875, 218.6989, 218.695, 218.8549, 219.0405, 219.1713, 
    219.2161, 219.0655, 218.777, 218.5038, 218.1785, 217.7294, 217.2596, 
    216.7632, 216.2373, 215.5967, 214.914, 214.2959, 214.0475, 214.0468, 
    214.2346, 214.6891, 215.3529,
  205.6025, 205.4783, 205.4046, 205.3981, 205.3795, 205.2533, 205.1838, 
    205.1559, 205.1979, 205.2677, 205.3536, 205.4408, 205.559, 205.6804, 
    205.8949, 206.1828, 206.4848, 206.7648, 207.1168, 207.5455, 208.1344, 
    208.7538, 209.4718, 210.0826, 210.7121, 211.3258, 211.9384, 212.4256, 
    212.7462, 212.8752, 212.8682, 212.7767, 212.6927, 212.5873, 212.6203, 
    212.8633, 213.3365, 213.7975,
  191.1005, 191.0178, 190.9687, 191.0074, 191.2332, 191.4993, 191.7905, 
    191.9939, 192.1039, 192.2045, 192.2962, 192.5578, 192.9607, 193.3062, 
    193.6118, 193.8455, 194.2255, 194.7322, 195.3778, 195.9864, 196.6215, 
    197.2579, 198.1301, 199.0317, 200.0051, 200.8208, 201.5201, 202.095, 
    202.8717, 203.7029, 204.655, 205.5495, 206.3363, 206.957, 207.5764, 
    208.1275, 208.7258, 209.3457,
  193.1017, 192.7229, 192.3414, 192.0889, 191.8839, 191.784, 191.7185, 
    191.8296, 192.1148, 192.5598, 193.2164, 193.8798, 194.6156, 195.2756, 
    195.9848, 196.5781, 197.0491, 197.3616, 197.5852, 197.7041, 197.8651, 
    198.1176, 198.4177, 198.7051, 199.0146, 199.2901, 199.6682, 200.1461, 
    200.7302, 201.2901, 201.8899, 202.4546, 203.2624, 204.2128, 205.2609, 
    206.1067, 206.9276, 207.6108,
  202.9877, 202.9409, 202.9271, 202.9865, 203.0919, 203.2055, 203.3907, 
    203.5565, 203.6609, 203.6596, 203.6282, 203.6623, 203.7746, 204.0321, 
    204.4315, 204.7729, 205.044, 205.228, 205.4496, 205.6934, 205.8999, 
    205.8945, 205.6483, 205.2986, 204.955, 204.7232, 204.5229, 204.369, 
    204.2815, 204.2946, 204.4621, 204.7775, 205.1658, 205.4754, 205.8481, 
    206.3399, 206.9413, 207.4582,
  208.1082, 207.9919, 207.8889, 207.7991, 207.7153, 207.6677, 207.6113, 
    207.545, 207.5381, 207.6781, 207.8996, 208.114, 208.3379, 208.4877, 
    208.5877, 208.6017, 208.5777, 208.6063, 208.7164, 208.818, 208.8663, 
    208.8286, 208.7062, 208.5048, 208.2317, 207.944, 207.5827, 207.2431, 
    206.9253, 206.7259, 206.6278, 206.5872, 206.5571, 206.5508, 206.6609, 
    206.8972, 207.2624, 207.6295,
  214.1841, 214.2026, 214.3108, 214.4733, 214.6848, 214.7785, 214.7373, 
    214.6459, 214.4722, 214.2507, 214.0218, 213.7918, 213.4529, 213.0492, 
    212.54, 212.1192, 211.8094, 211.6597, 211.5613, 211.472, 211.3509, 
    211.2202, 211.0755, 210.9776, 210.8599, 210.6965, 210.4525, 210.1207, 
    209.6864, 209.3763, 209.0868, 208.8124, 208.5809, 208.5198, 208.597, 
    208.7473, 208.95, 209.181,
  222.8497, 223.0594, 223.114, 223.012, 222.8005, 222.5631, 222.2497, 
    221.9103, 221.4886, 221.0455, 220.5101, 219.9892, 219.4634, 219.0609, 
    218.7059, 218.4095, 218.055, 217.6667, 217.2298, 216.8649, 216.5303, 
    216.2348, 215.8458, 215.3859, 214.8698, 214.4277, 214.0261, 213.7438, 
    213.4981, 213.2378, 212.8658, 212.6234, 212.7691, 213.0791, 213.4113, 
    213.6112, 213.7546, 213.8129,
  229.7742, 229.6571, 229.6671, 229.8091, 230.0452, 230.298, 230.6086, 
    230.9403, 231.3576, 231.7421, 232.0648, 232.2109, 232.1555, 231.8916, 
    231.4265, 230.9102, 230.3004, 229.656, 228.7819, 227.8303, 226.781, 
    225.9153, 225.141, 224.537, 223.8849, 223.2363, 222.5446, 222.0028, 
    221.7768, 221.8299, 221.8386, 221.6634, 221.2874, 220.9106, 220.514, 
    220.0973, 219.6078, 219.1676,
  230.4996, 230.5406, 230.6041, 230.6494, 230.7177, 230.8413, 231.0036, 
    231.2338, 231.6124, 232.0423, 232.5109, 232.923, 233.3362, 233.6679, 
    233.9008, 233.9264, 233.7169, 233.3157, 232.7066, 232.0198, 231.1821, 
    230.5237, 229.8334, 229.148, 228.377, 227.8227, 227.5405, 227.5, 
    227.3542, 227.0995, 226.7991, 226.4713, 225.8699, 225.2823, 224.598, 
    223.9214, 223.3694, 222.9639,
  233.4433, 233.3191, 233.282, 233.3045, 233.3426, 233.3549, 233.3495, 
    233.3502, 233.3278, 233.2774, 233.1605, 233.0263, 232.9143, 232.8896, 
    232.9639, 233.1001, 233.2836, 233.4707, 233.7067, 234.0107, 234.39, 
    234.6502, 234.924, 235.3093, 235.9073, 236.4886, 236.8927, 236.7643, 
    236.0916, 235.4351, 234.836, 234.2185, 233.6904, 233.2178, 232.5397, 
    231.8517, 231.0496, 230.2946,
  237.0579, 236.7898, 236.4923, 236.2305, 235.9971, 235.8315, 235.7104, 
    235.5941, 235.3582, 235.0291, 234.6139, 234.252, 233.9189, 233.7041, 
    233.6443, 233.8108, 234.2835, 235.0089, 236.0714, 237.2014, 238.4972, 
    239.6714, 240.9454, 242.1068, 243.2251, 243.9779, 244.3671, 244.3636, 
    244.135, 243.5948, 242.5026, 241.3903, 240.3915, 239.5988, 238.8388, 
    238.162, 237.298, 236.2483,
  240.9674, 240.4028, 239.8165, 239.3418, 238.8981, 238.5308, 238.1991, 
    237.9139, 237.6168, 237.3951, 237.2697, 237.2939, 237.5178, 237.9037, 
    238.4951, 239.2322, 240.2416, 241.332, 242.7231, 244.219, 245.9762, 
    247.6015, 249.252, 250.5636, 251.6584, 252.3119, 252.7398, 253.1272, 
    253.548, 253.6286, 253.125, 252.2201, 251.0132, 249.7443, 248.263, 
    246.9388, 245.5673, 244.3894,
  247.1399, 246.4659, 245.9161, 245.5551, 245.3291, 245.2436, 245.2969, 
    245.4924, 245.8581, 246.3661, 247.0677, 247.7707, 248.5154, 249.1431, 
    249.7699, 250.3181, 250.9545, 251.6631, 252.5619, 253.3983, 254.2596, 
    255.0064, 255.8047, 256.5201, 257.2738, 258.0444, 258.9647, 259.73, 
    260.2407, 260.4878, 260.7121, 260.716, 260.2159, 259.2604, 257.866, 
    256.5093, 255.0111, 253.5362,
  254.4559, 254.3317, 254.2006, 254.1482, 254.256, 254.5438, 255.0278, 
    255.6001, 256.2652, 256.8595, 257.4236, 257.9189, 258.5341, 259.2768, 
    260.1539, 260.9689, 261.7766, 262.4018, 262.8936, 263.1665, 263.2979, 
    263.3415, 263.4279, 263.5865, 263.7652, 263.8321, 263.7527, 263.5854, 
    263.3465, 263.0465, 262.6325, 262.2043, 261.7246, 261.1578, 260.2676, 
    259.1013, 257.46, 255.5639,
  261.0162, 261.0003, 260.8569, 260.7489, 260.7153, 260.6578, 260.6127, 
    260.5971, 260.5348, 260.4711, 260.4439, 260.5484, 260.9094, 261.361, 
    261.951, 262.4258, 262.8368, 263.1388, 263.3834, 263.5604, 263.7135, 
    263.7987, 263.8332, 263.731, 263.3994, 262.9037, 262.3289, 261.8696, 
    261.377, 260.8161, 259.9762, 259.1796, 258.4608, 258.0001, 257.528, 
    257.0327, 256.4113, 255.5495,
  265.4118, 265.9258, 266.3802, 266.6792, 266.7267, 266.4491, 265.8279, 
    265.1269, 264.3371, 263.6673, 263.0308, 262.4681, 261.8054, 261.1666, 
    260.4343, 259.7679, 259.0477, 258.4406, 257.947, 257.6769, 257.555, 
    257.5074, 257.3423, 257.0032, 256.4594, 255.884, 255.2869, 254.8206, 
    254.4073, 254.0846, 253.794, 253.4984, 253.085, 252.6179, 252.1773, 
    251.9289, 251.7172, 251.4509,
  264.8954, 265.6873, 266.5133, 267.0556, 267.1951, 266.9029, 266.2476, 
    265.4413, 264.4705, 263.5279, 262.5052, 261.5432, 260.4144, 259.2407, 
    257.8726, 256.5909, 255.2739, 254.2625, 253.4752, 252.9822, 252.6189, 
    252.3267, 251.9353, 251.4473, 250.801, 250.1981, 249.6311, 249.2342, 
    248.9853, 248.9244, 249.0325, 249.1678, 249.1185, 248.8573, 248.6413, 
    248.6477, 248.6725, 248.5071,
  259.2368, 260.004, 260.6595, 260.9967, 261.1042, 261.0214, 260.7845, 
    260.3726, 259.7247, 259.0245, 258.1774, 257.2948, 256.1644, 254.9654, 
    253.58, 252.2856, 250.9601, 249.8649, 248.8674, 248.082, 247.3266, 
    246.6516, 245.9352, 245.2959, 244.6871, 244.2593, 243.9117, 243.6204, 
    243.3476, 243.2416, 243.3264, 243.5211, 243.732, 243.9117, 244.0996, 
    244.3295, 244.4671, 244.4764,
  236.1083, 236.1081, 236.3078, 236.667, 237.1786, 237.7129, 238.3108, 
    238.7644, 239.1441, 239.5064, 239.8806, 240.1412, 240.3717, 240.5517, 
    240.7104, 240.7214, 240.4984, 240.0549, 239.3248, 238.4476, 237.4317, 
    236.5342, 235.6283, 234.8011, 233.8352, 232.8638, 231.799, 230.8872, 
    230.0298, 229.3347, 228.6411, 228.0092, 227.2659, 226.5559, 226.0728, 
    225.9926, 226.1723, 226.5721 ;

 lat = -5.625, -4.375, -3.125, -1.875, -0.625, 0.625, 1.875, 3.125, 4.375, 
    5.625, 6.875, 8.125, 9.375, 10.625, 11.875, 13.125, 14.375, 15.625, 
    16.875, 18.125, 19.375, 20.625, 21.875, 23.125, 24.375, 25.625, 26.875, 
    28.125, 29.375, 30.625, 31.875, 33.125, 34.375, 35.625, 36.875, 38.125, 
    39.375, 40.625 ;

 lat_bnds =
  -6.25, -5,
  -5, -3.75,
  -3.75, -2.5,
  -2.5, -1.25,
  -1.25, 0,
  0, 1.25,
  1.25, 2.5,
  2.5, 3.75,
  3.75, 5,
  5, 6.25,
  6.25, 7.5,
  7.5, 8.75,
  8.75, 10,
  10, 11.25,
  11.25, 12.5,
  12.5, 13.75,
  13.75, 15,
  15, 16.25,
  16.25, 17.5,
  17.5, 18.75,
  18.75, 20,
  20, 21.25,
  21.25, 22.5,
  22.5, 23.75,
  23.75, 25,
  25, 26.25,
  26.25, 27.5,
  27.5, 28.75,
  28.75, 30,
  30, 31.25,
  31.25, 32.5,
  32.5, 33.75,
  33.75, 35,
  35, 36.25,
  36.25, 37.5,
  37.5, 38.75,
  38.75, 40,
  40, 41.25 ;

 lon = -53.125 ;

 lon_bnds = -53.75, -52.5 ;
}
