# Use modules
use strict;
use Test::More tests => 2;
use Giovanni::Testing;
use Giovanni::Algorithm::Wrapper;
use Giovanni::Algorithm::Wrapper::Test;

# Find path for $program
my $program = 'g4_scatterplot.pl';
my ($script_path) = Giovanni::Testing::find_script_paths($program);

# The actual call to run the test
# Note that diff-exclude is used to exclude potentially spurious differences
# In real life, we will want to take the out of the diff-exclude, once we settle
# on title formats and contents
my ( $out_nc, $diff_rc ) = run_test(
    'program'      => "$script_path -y ttl",
    'name'         => 'Static Scatter',
    'comparison'   => "vs",
    'z-slice'      => [ 700, 1000 ],
    'bbox'         => '-97.8984, 24.9727, -88.0547, 32.0039',
    'diff-exclude' => [
        qw(/title /latitude_resolution /longitude_resolution)
    ]
);
ok( $out_nc, "Algorithm returned file $out_nc" );
is( $diff_rc, '', "Outcome of diff" );

__DATA__

netcdf scrubbed.AIRX3STM_006_GPHeight_A.20050101 {
dimensions:
	time = UNLIMITED ; // (1 currently)
	TempPrsLvls_A = 24 ;
	lat = 7 ;
	lon = 10 ;
	latv = 2 ;
	lonv = 2 ;
	nv = 2 ;
variables:
	float AIRX3STM_006_GPHeight_A(time, TempPrsLvls_A, lat, lon) ;
		AIRX3STM_006_GPHeight_A:_FillValue = -9999.f ;
		AIRX3STM_006_GPHeight_A:standard_name = "geopotential_height" ;
		AIRX3STM_006_GPHeight_A:quantity_type = "Geopotential" ;
		AIRX3STM_006_GPHeight_A:product_short_name = "AIRX3STM" ;
		AIRX3STM_006_GPHeight_A:product_version = "006" ;
		AIRX3STM_006_GPHeight_A:long_name = "Geopotential Height (Daytime/Ascending)" ;
		AIRX3STM_006_GPHeight_A:coordinates = "time TempPrsLvls_A lat lon" ;
		AIRX3STM_006_GPHeight_A:units = "m" ;
	float TempPrsLvls_A(TempPrsLvls_A) ;
		TempPrsLvls_A:long_name = "Pressure" ;
		TempPrsLvls_A:format = "F7.2" ;
		TempPrsLvls_A:standard_name = "stdpressurelev" ;
		TempPrsLvls_A:units = "hPa" ;
	int datamonth(time) ;
		datamonth:long_name = "Standardized Date Label" ;
	double lat(lat) ;
		lat:units = "degrees_north" ;
		lat:format = "F5.1" ;
		lat:missing_value = -9999.f ;
		lat:standard_name = "latitude" ;
		lat:bounds = "lat_bnds" ;
	double lat_bnds(lat, latv) ;
		lat_bnds:units = "degrees_north" ;
	double lon(lon) ;
		lon:units = "degrees_east" ;
		lon:format = "F6.1" ;
		lon:missing_value = -9999.f ;
		lon:standard_name = "longitude" ;
		lon:bounds = "lon_bnds" ;
	double lon_bnds(lon, lonv) ;
		lon_bnds:units = "degrees_east" ;
	int time(time) ;
		time:long_name = "time" ;
		time:standard_name = "time" ;
		time:units = "seconds since 1970-01-01 00:00:00" ;
		time:bounds = "time_bnds" ;
	int time_bnds(time, nv) ;
		time_bnds:units = "seconds since 1970-01-01 00:00:00" ;

// global attributes:
		:Conventions = "CF-1.4" ;
		:start_time = "2005-01-01T00:00:00Z" ;
		:end_time = "2005-01-31T23:59:59Z" ;
		:temporal_resolution = "monthly" ;
		:NCO = "\"4.5.3\"" ;
		:nco_openmp_thread_number = 1 ;
		:history = "Tue Nov 15 21:58:53 2016: ncks -d lon,-97.8984,-88.0547 -d lat,24.9727,32.0039 scrubbed.AIRX3STM_006_GPHeight_A.20050101.nc scrubbed.AIRX3STM_006_GPHeight_A.20050101.nc" ;
data:

 AIRX3STM_006_GPHeight_A =
  167, 170, 172, 174, 176, 175, 176, 177, 178, 179,
  172, 174, 176, 176, 181, 181, 179, 179, 181, 182,
  172, 178, 180, 180, 184, 185, 184, 183, 184, 185,
  181, 182, 184, 183, 185, 189, 187, 186, 186, 188,
  191, 187, 188, 188, 187, 194, 188, 194, 193, 193,
  221, 194, 193, 191, 192, 195, 194, 194, 195, 196,
  234, 209, 199, 195, 197, 198, 198, 200, 203, 202,
  833, 835, 838, 840, 842, 841, 842, 842, 844, 845,
  836, 838, 841, 841, 846, 846, 844, 844, 845, 846,
  835, 840, 843, 843, 847, 848, 848, 846, 847, 847,
  841, 842, 844, 842, 846, 849, 848, 848, 847, 848,
  844, 844, 845, 845, 845, 851, 845, 850, 850, 850,
  846, 847, 848, 845, 846, 848, 848, 847, 849, 850,
  845, 850, 850, 849, 851, 851, 850, 851, 854, 853,
  1545, 1547, 1549, 1551, 1553, 1552, 1553, 1553, 1554, 1554,
  1547, 1548, 1551, 1550, 1556, 1556, 1553, 1553, 1554, 1554,
  1544, 1548, 1551, 1550, 1555, 1556, 1556, 1555, 1554, 1554,
  1546, 1548, 1550, 1548, 1553, 1556, 1554, 1554, 1554, 1553,
  1549, 1548, 1548, 1550, 1549, 1556, 1549, 1553, 1553, 1552,
  1548, 1549, 1549, 1546, 1547, 1549, 1549, 1548, 1551, 1551,
  1546, 1549, 1550, 1550, 1552, 1552, 1550, 1551, 1553, 1552,
  3155, 3156, 3158, 3160, 3161, 3160, 3161, 3161, 3162, 3162,
  3155, 3155, 3157, 3157, 3163, 3163, 3160, 3159, 3159, 3158,
  3151, 3152, 3154, 3154, 3158, 3160, 3159, 3158, 3156, 3156,
  3146, 3149, 3152, 3148, 3153, 3156, 3155, 3155, 3153, 3152,
  3145, 3145, 3144, 3147, 3148, 3154, 3146, 3150, 3150, 3146,
  3140, 3141, 3141, 3139, 3141, 3144, 3142, 3142, 3144, 3142,
  3135, 3135, 3137, 3140, 3143, 3144, 3140, 3141, 3142, 3139,
  4402, 4402, 4405, 4408, 4409, 4407, 4408, 4408, 4409, 4409,
  4400, 4399, 4402, 4402, 4409, 4409, 4406, 4404, 4404, 4403,
  4395, 4394, 4396, 4397, 4401, 4403, 4403, 4401, 4399, 4398,
  4385, 4389, 4391, 4388, 4394, 4396, 4396, 4396, 4393, 4392,
  4382, 4383, 4381, 4384, 4386, 4393, 4384, 4388, 4389, 4382,
  4373, 4376, 4375, 4373, 4376, 4381, 4377, 4378, 4380, 4376,
  4367, 4366, 4368, 4371, 4376, 4379, 4374, 4374, 4375, 4371,
  5835, 5835, 5839, 5842, 5844, 5842, 5843, 5843, 5844, 5844,
  5830, 5829, 5833, 5832, 5841, 5841, 5838, 5836, 5836, 5834,
  5823, 5821, 5824, 5825, 5830, 5832, 5832, 5829, 5828, 5826,
  5808, 5813, 5815, 5812, 5819, 5822, 5822, 5822, 5819, 5818,
  5803, 5804, 5801, 5804, 5808, 5816, 5805, 5811, 5812, 5804,
  5789, 5794, 5791, 5790, 5794, 5800, 5795, 5797, 5799, 5794,
  5782, 5779, 5782, 5787, 5793, 5797, 5791, 5790, 5790, 5785,
  7520, 7519, 7525, 7528, 7531, 7529, 7530, 7530, 7531, 7530,
  7509, 7509, 7514, 7513, 7523, 7524, 7522, 7519, 7518, 7516,
  7499, 7497, 7501, 7503, 7509, 7511, 7511, 7507, 7507, 7503,
  7477, 7485, 7487, 7486, 7494, 7497, 7497, 7498, 7494, 7492,
  7468, 7471, 7468, 7472, 7478, 7486, 7475, 7481, 7482, 7474,
  7449, 7456, 7453, 7454, 7459, 7466, 7460, 7464, 7465, 7458,
  7440, 7436, 7441, 7447, 7456, 7460, 7455, 7452, 7452, 7445,
  9569, 9568, 9575, 9581, 9583, 9582, 9583, 9583, 9583, 9582,
  9552, 9553, 9559, 9559, 9571, 9573, 9569, 9566, 9564, 9562,
  9537, 9535, 9540, 9543, 9551, 9553, 9553, 9548, 9547, 9543,
  9508, 9517, 9520, 9520, 9531, 9534, 9534, 9534, 9530, 9527,
  9492, 9496, 9495, 9499, 9508, 9518, 9505, 9512, 9513, 9503,
  9467, 9477, 9473, 9477, 9485, 9493, 9484, 9489, 9490, 9481,
  9455, 9449, 9456, 9467, 9478, 9482, 9477, 9472, 9470, 9462,
  10803, 10802, 10809, 10815, 10818, 10817, 10818, 10817, 10818, 10816,
  10782, 10783, 10789, 10789, 10803, 10805, 10801, 10797, 10796, 10794,
  10764, 10762, 10768, 10772, 10780, 10783, 10782, 10777, 10776, 10772,
  10733, 10741, 10743, 10744, 10756, 10759, 10759, 10760, 10756, 10752,
  10713, 10717, 10716, 10719, 10729, 10740, 10727, 10734, 10736, 10723,
  10684, 10695, 10690, 10695, 10704, 10712, 10703, 10708, 10709, 10699,
  10669, 10662, 10671, 10683, 10694, 10699, 10694, 10688, 10684, 10677,
  12250, 12249, 12256, 12263, 12266, 12264, 12264, 12263, 12265, 12263,
  12226, 12229, 12234, 12235, 12249, 12250, 12245, 12241, 12241, 12240,
  12205, 12204, 12210, 12215, 12222, 12225, 12226, 12220, 12220, 12216,
  12174, 12180, 12181, 12183, 12196, 12198, 12199, 12200, 12196, 12192,
  12149, 12153, 12153, 12155, 12165, 12176, 12164, 12172, 12172, 12159,
  12117, 12128, 12123, 12130, 12137, 12146, 12137, 12142, 12142, 12131,
  12098, 12092, 12101, 12113, 12122, 12128, 12124, 12118, 12113, 12107,
  14040, 14040, 14047, 14054, 14056, 14053, 14054, 14053, 14054, 14052,
  14017, 14023, 14028, 14028, 14040, 14038, 14035, 14032, 14032, 14030,
  13996, 13997, 14003, 14008, 14012, 14015, 14017, 14012, 14012, 14009,
  13970, 13973, 13976, 13977, 13986, 13988, 13991, 13992, 13987, 13983,
  13940, 13943, 13946, 13949, 13955, 13966, 13956, 13962, 13960, 13951,
  13909, 13918, 13916, 13921, 13925, 13934, 13926, 13930, 13930, 13920,
  13887, 13885, 13891, 13902, 13905, 13911, 13910, 13906, 13899, 13897,
  16465, 16463, 16468, 16471, 16473, 16469, 16470, 16470, 16469, 16468,
  16449, 16453, 16455, 16454, 16462, 16459, 16457, 16456, 16453, 16451,
  16434, 16433, 16438, 16441, 16441, 16443, 16445, 16442, 16440, 16437,
  16420, 16419, 16421, 16419, 16423, 16424, 16427, 16427, 16423, 16418,
  16393, 16396, 16398, 16400, 16401, 16409, 16401, 16406, 16402, 16395,
  16370, 16375, 16376, 16378, 16378, 16385, 16378, 16381, 16381, 16373,
  16353, 16352, 16355, 16363, 16362, 16367, 16366, 16364, 16357, 16358,
  18553, 18550, 18552, 18554, 18553, 18550, 18550, 18550, 18549, 18548,
  18544, 18546, 18546, 18544, 18548, 18546, 18544, 18544, 18540, 18538,
  18539, 18534, 18537, 18539, 18537, 18536, 18538, 18535, 18533, 18532,
  18533, 18529, 18528, 18526, 18528, 18525, 18528, 18529, 18524, 18522,
  18514, 18515, 18515, 18516, 18514, 18519, 18511, 18516, 18513, 18508,
  18501, 18501, 18503, 18503, 18500, 18503, 18498, 18500, 18501, 18494,
  18490, 18488, 18490, 18497, 18494, 18496, 18496, 18492, 18487, 18487,
  20562, 20561, 20562, 20563, 20561, 20559, 20559, 20558, 20557, 20556,
  20559, 20560, 20560, 20558, 20559, 20557, 20556, 20556, 20553, 20552,
  20558, 20554, 20556, 20557, 20554, 20551, 20554, 20551, 20551, 20551,
  20555, 20551, 20550, 20549, 20550, 20546, 20548, 20551, 20546, 20546,
  20543, 20542, 20542, 20543, 20540, 20542, 20536, 20540, 20538, 20537,
  20535, 20532, 20534, 20534, 20529, 20530, 20527, 20527, 20530, 20525,
  20528, 20525, 20527, 20532, 20529, 20530, 20530, 20525, 20522, 20523,
  23736, 23734, 23735, 23735, 23733, 23731, 23733, 23731, 23732, 23731,
  23735, 23734, 23735, 23731, 23732, 23731, 23729, 23730, 23728, 23729,
  23731, 23728, 23731, 23731, 23727, 23726, 23728, 23727, 23728, 23729,
  23729, 23726, 23726, 23723, 23724, 23720, 23721, 23727, 23722, 23725,
  23720, 23717, 23719, 23720, 23714, 23716, 23710, 23716, 23716, 23719,
  23712, 23712, 23714, 23710, 23704, 23706, 23704, 23704, 23709, 23705,
  23705, 23705, 23707, 23706, 23704, 23705, 23706, 23703, 23704, 23709,
  26343, 26338, 26340, 26339, 26337, 26336, 26339, 26337, 26337, 26337,
  26341, 26338, 26339, 26335, 26336, 26334, 26333, 26335, 26333, 26335,
  26335, 26331, 26335, 26335, 26330, 26329, 26331, 26332, 26333, 26333,
  26335, 26333, 26333, 26324, 26326, 26320, 26324, 26330, 26325, 26329,
  26327, 26323, 26326, 26325, 26315, 26317, 26312, 26319, 26317, 26323,
  26315, 26322, 26324, 26316, 26304, 26310, 26307, 26307, 26317, 26311,
  26308, 26313, 26316, 26309, 26304, 26306, 26307, 26308, 26313, 26324,
  28227, 28222, 28224, 28223, 28219, 28219, 28223, 28222, 28221, 28221,
  28225, 28222, 28224, 28219, 28218, 28216, 28217, 28221, 28217, 28220,
  28217, 28215, 28219, 28219, 28212, 28211, 28214, 28216, 28217, 28218,
  28221, 28219, 28218, 28207, 28209, 28201, 28208, 28213, 28208, 28212,
  28211, 28207, 28211, 28208, 28197, 28198, 28194, 28201, 28198, 28207,
  28198, 28210, 28212, 28201, 28184, 28192, 28189, 28188, 28204, 28195,
  28191, 28200, 28205, 28192, 28184, 28188, 28188, 28192, 28199, 28216,
  30930, 30924, 30927, 30925, 30919, 30922, 30926, 30927, 30926, 30926,
  30926, 30924, 30927, 30922, 30917, 30917, 30920, 30927, 30922, 30925,
  30918, 30918, 30921, 30922, 30912, 30910, 30916, 30920, 30922, 30925,
  30927, 30925, 30922, 30910, 30913, 30902, 30912, 30916, 30911, 30916,
  30915, 30909, 30913, 30910, 30897, 30901, 30897, 30906, 30900, 30911,
  30901, 30917, 30919, 30903, 30883, 30895, 30893, 30892, 30913, 30901,
  30894, 30904, 30912, 30895, 30883, 30892, 30889, 30898, 30908, 30931,
  33319, 33312, 33316, 33314, 33308, 33313, 33318, 33320, 33320, 33319,
  33314, 33313, 33317, 33311, 33305, 33306, 33311, 33321, 33316, 33319,
  33305, 33306, 33311, 33311, 33301, 33299, 33305, 33311, 33315, 33322,
  33319, 33315, 33310, 33299, 33303, 33292, 33304, 33308, 33304, 33310,
  33304, 33297, 33300, 33299, 33285, 33293, 33290, 33300, 33293, 33305,
  33291, 33307, 33311, 33292, 33269, 33287, 33287, 33286, 33310, 33295,
  33285, 33293, 33305, 33285, 33273, 33285, 33280, 33293, 33306, 33331,
  35619, 35611, 35618, 35615, 35610, 35616, 35622, 35625, 35626, 35625,
  35613, 35612, 35618, 35612, 35607, 35609, 35614, 35625, 35621, 35625,
  35602, 35604, 35612, 35611, 35604, 35602, 35607, 35614, 35620, 35629,
  35618, 35614, 35608, 35599, 35604, 35595, 35605, 35612, 35608, 35617,
  35603, 35596, 35600, 35602, 35585, 35599, 35595, 35606, 35601, 35612,
  35590, 35607, 35615, 35594, 35569, 35591, 35593, 35593, 35617, 35602,
  35585, 35592, 35609, 35587, 35577, 35590, 35584, 35598, 35614, 35639,
  39234, 39225, 39236, 39234, 39231, 39235, 39244, 39244, 39248, 39246,
  39226, 39227, 39233, 39228, 39227, 39231, 39234, 39242, 39241, 39246,
  39212, 39215, 39228, 39226, 39224, 39223, 39226, 39233, 39240, 39248,
  39229, 39224, 39220, 39213, 39219, 39215, 39220, 39232, 39229, 39240,
  39214, 39211, 39214, 39221, 39203, 39220, 39212, 39228, 39226, 39236,
  39201, 39218, 39230, 39211, 39186, 39209, 39213, 39215, 39238, 39225,
  39197, 39206, 39226, 39203, 39195, 39206, 39200, 39215, 39237, 39258,
  42220, 42213, 42225, 42225, 42223, 42225, 42235, 42233, 42237, 42235,
  42215, 42215, 42222, 42216, 42217, 42223, 42224, 42229, 42230, 42235,
  42200, 42203, 42216, 42215, 42212, 42214, 42217, 42222, 42228, 42234,
  42215, 42210, 42208, 42200, 42206, 42205, 42208, 42221, 42219, 42229,
  42201, 42199, 42202, 42212, 42193, 42206, 42198, 42215, 42215, 42225,
  42186, 42198, 42211, 42195, 42175, 42194, 42197, 42199, 42220, 42212,
  42181, 42192, 42209, 42187, 42182, 42190, 42184, 42196, 42218, 42235,
  44431, 44426, 44437, 44438, 44435, 44436, 44446, 44444, 44447, 44445,
  44430, 44429, 44435, 44429, 44430, 44435, 44437, 44440, 44441, 44445,
  44417, 44417, 44429, 44428, 44425, 44427, 44431, 44435, 44439, 44444,
  44429, 44423, 44423, 44413, 44418, 44418, 44422, 44433, 44431, 44440,
  44414, 44414, 44415, 44425, 44407, 44416, 44409, 44424, 44425, 44435,
  44400, 44407, 44418, 44405, 44390, 44404, 44404, 44407, 44426, 44423,
  44393, 44405, 44417, 44398, 44395, 44400, 44393, 44403, 44423, 44437,
  47537, 47533, 47543, 47545, 47543, 47541, 47551, 47548, 47550, 47549,
  47540, 47538, 47543, 47538, 47541, 47543, 47545, 47546, 47547, 47550,
  47530, 47528, 47538, 47539, 47535, 47537, 47542, 47544, 47546, 47549,
  47539, 47531, 47534, 47524, 47528, 47528, 47532, 47543, 47541, 47548,
  47522, 47523, 47523, 47534, 47518, 47524, 47518, 47531, 47532, 47542,
  47507, 47510, 47518, 47508, 47501, 47511, 47510, 47512, 47529, 47530,
  47497, 47511, 47517, 47502, 47501, 47505, 47498, 47507, 47522, 47536 ;

 TempPrsLvls_A = 1000, 925, 850, 700, 600, 500, 400, 300, 250, 200, 150, 100, 
    70, 50, 30, 20, 15, 10, 7, 5, 3, 2, 1.5, 1 ;

 datamonth = 200501 ;

 lat = 25.5, 26.5, 27.5, 28.5, 29.5, 30.5, 31.5 ;

 lat_bnds =
  25, 26,
  26, 27,
  27, 28,
  28, 29,
  29, 30,
  30, 31,
  31, 32 ;

 lon = -97.5, -96.5, -95.5, -94.5, -93.5, -92.5, -91.5, -90.5, -89.5, -88.5 ;

 lon_bnds =
  -98, -97,
  -97, -96,
  -96, -95,
  -95, -94,
  -94, -93,
  -93, -92,
  -92, -91,
  -91, -90,
  -90, -89,
  -89, -88 ;

 time = 1104537600 ;

 time_bnds =
  1104537600, 1107215999 ;
}
netcdf scrubbed.AIRX3STM_006_GPHeight_D.20050101 {
dimensions:
	time = UNLIMITED ; // (1 currently)
	TempPrsLvls_D = 24 ;
	lat = 7 ;
	lon = 10 ;
	latv = 2 ;
	lonv = 2 ;
	nv = 2 ;
variables:
	float AIRX3STM_006_GPHeight_D(time, TempPrsLvls_D, lat, lon) ;
		AIRX3STM_006_GPHeight_D:_FillValue = -9999.f ;
		AIRX3STM_006_GPHeight_D:standard_name = "geopotential_height" ;
		AIRX3STM_006_GPHeight_D:quantity_type = "Geopotential" ;
		AIRX3STM_006_GPHeight_D:product_short_name = "AIRX3STM" ;
		AIRX3STM_006_GPHeight_D:product_version = "006" ;
		AIRX3STM_006_GPHeight_D:long_name = "Geopotential Height (Nighttime/Descending)" ;
		AIRX3STM_006_GPHeight_D:coordinates = "time TempPrsLvls_D lat lon" ;
		AIRX3STM_006_GPHeight_D:units = "m" ;
	float TempPrsLvls_D(TempPrsLvls_D) ;
		TempPrsLvls_D:long_name = "Pressure" ;
		TempPrsLvls_D:format = "F7.2" ;
		TempPrsLvls_D:standard_name = "stdpressurelev" ;
		TempPrsLvls_D:units = "hPa" ;
	int datamonth(time) ;
		datamonth:long_name = "Standardized Date Label" ;
	double lat(lat) ;
		lat:units = "degrees_north" ;
		lat:format = "F5.1" ;
		lat:missing_value = -9999.f ;
		lat:standard_name = "latitude" ;
		lat:bounds = "lat_bnds" ;
	double lat_bnds(lat, latv) ;
		lat_bnds:units = "degrees_north" ;
	double lon(lon) ;
		lon:units = "degrees_east" ;
		lon:format = "F6.1" ;
		lon:missing_value = -9999.f ;
		lon:standard_name = "longitude" ;
		lon:bounds = "lon_bnds" ;
	double lon_bnds(lon, lonv) ;
		lon_bnds:units = "degrees_east" ;
	int time(time) ;
		time:long_name = "time" ;
		time:standard_name = "time" ;
		time:units = "seconds since 1970-01-01 00:00:00" ;
		time:bounds = "time_bnds" ;
	int time_bnds(time, nv) ;
		time_bnds:units = "seconds since 1970-01-01 00:00:00" ;

// global attributes:
		:Conventions = "CF-1.4" ;
		:start_time = "2005-01-01T00:00:00Z" ;
		:end_time = "2005-01-31T23:59:59Z" ;
		:temporal_resolution = "monthly" ;
		:NCO = "\"4.5.3\"" ;
		:nco_openmp_thread_number = 1 ;
		:history = "Tue Nov 15 21:59:06 2016: ncks -d lon,-97.8984,-88.0547 -d lat,24.9727,32.0039 scrubbed.AIRX3STM_006_GPHeight_D.20050101.nc scrubbed.AIRX3STM_006_GPHeight_D.20050101.nc" ;
data:

 AIRX3STM_006_GPHeight_D =
  168, 169, 169, 171, 176, 180, 179, 177, 177, 177,
  171, 169, 168, 174, 180, 181, 183, 182, 182, 180,
  176, 176, 176, 180, 182, 184, 187, 187, 185, 186,
  179, 181, 181, 185, 187, 187, 192, 191, 189, 187,
  198, 187, 188, 190, 191, 191, 192, 191, 193, 193,
  222, 199, 192, 191, 193, 194, 191, 192, 192, 195,
  238, 210, 201, 191, 190, 191, 192, 197, 196, 192,
  833, 835, 835, 838, 841, 844, 844, 842, 841, 842,
  833, 834, 834, 839, 844, 845, 847, 846, 846, 844,
  835, 838, 839, 843, 844, 846, 849, 849, 846, 848,
  836, 840, 840, 845, 847, 848, 851, 850, 849, 848,
  841, 841, 844, 846, 848, 849, 850, 848, 848, 850,
  844, 848, 846, 845, 847, 847, 845, 847, 846, 849,
  840, 843, 842, 841, 843, 843, 845, 847, 846, 844,
  1545, 1548, 1548, 1550, 1552, 1554, 1553, 1551, 1551, 1551,
  1543, 1546, 1545, 1549, 1553, 1553, 1555, 1554, 1554, 1552,
  1544, 1547, 1547, 1551, 1552, 1553, 1555, 1555, 1553, 1554,
  1544, 1547, 1548, 1551, 1553, 1554, 1556, 1555, 1553, 1553,
  1548, 1547, 1548, 1551, 1553, 1554, 1555, 1552, 1551, 1553,
  1550, 1553, 1549, 1548, 1549, 1549, 1549, 1549, 1548, 1552,
  1543, 1546, 1545, 1545, 1546, 1545, 1548, 1548, 1548, 1545,
  3158, 3161, 3161, 3162, 3161, 3161, 3160, 3158, 3157, 3157,
  3152, 3159, 3156, 3158, 3160, 3159, 3160, 3159, 3158, 3157,
  3151, 3155, 3154, 3156, 3156, 3156, 3157, 3158, 3154, 3155,
  3147, 3151, 3152, 3153, 3155, 3156, 3156, 3155, 3151, 3151,
  3149, 3146, 3146, 3150, 3151, 3152, 3153, 3149, 3147, 3148,
  3146, 3148, 3144, 3142, 3143, 3141, 3142, 3142, 3140, 3145,
  3132, 3136, 3138, 3141, 3139, 3138, 3141, 3137, 3136, 3133,
  4407, 4410, 4410, 4411, 4409, 4408, 4407, 4405, 4404, 4405,
  4398, 4407, 4404, 4404, 4405, 4404, 4405, 4405, 4403, 4402,
  4394, 4399, 4398, 4399, 4399, 4399, 4399, 4400, 4396, 4397,
  4388, 4392, 4393, 4394, 4396, 4396, 4396, 4395, 4389, 4390,
  4388, 4383, 4384, 4388, 4388, 4389, 4390, 4386, 4382, 4385,
  4382, 4383, 4378, 4378, 4377, 4376, 4377, 4376, 4373, 4379,
  4363, 4368, 4372, 4376, 4374, 4373, 4374, 4369, 4368, 4365,
  5842, 5845, 5844, 5846, 5843, 5841, 5840, 5839, 5838, 5839,
  5829, 5839, 5835, 5835, 5835, 5834, 5835, 5835, 5834, 5833,
  5820, 5827, 5825, 5826, 5825, 5825, 5825, 5827, 5823, 5824,
  5811, 5817, 5818, 5817, 5818, 5820, 5820, 5819, 5813, 5814,
  5809, 5804, 5805, 5809, 5806, 5808, 5809, 5806, 5801, 5805,
  5800, 5800, 5795, 5795, 5794, 5793, 5794, 5794, 5791, 5797,
  5775, 5782, 5787, 5792, 5790, 5790, 5792, 5785, 5784, 5780,
  7528, 7531, 7530, 7531, 7527, 7525, 7524, 7523, 7523, 7525,
  7511, 7522, 7516, 7515, 7515, 7513, 7514, 7516, 7515, 7514,
  7494, 7504, 7501, 7502, 7501, 7500, 7499, 7502, 7500, 7501,
  7483, 7490, 7490, 7488, 7489, 7492, 7492, 7492, 7486, 7487,
  7478, 7472, 7474, 7477, 7472, 7475, 7476, 7474, 7468, 7474,
  7465, 7465, 7458, 7458, 7455, 7456, 7458, 7457, 7454, 7461,
  7432, 7442, 7448, 7453, 7451, 7451, 7455, 7444, 7444, 7439,
  9578, 9582, 9581, 9582, 9577, 9574, 9573, 9573, 9573, 9575,
  9556, 9569, 9562, 9559, 9559, 9556, 9557, 9561, 9560, 9560,
  9532, 9543, 9541, 9541, 9539, 9539, 9537, 9541, 9540, 9542,
  9516, 9524, 9525, 9521, 9522, 9526, 9526, 9527, 9521, 9522,
  9506, 9501, 9504, 9505, 9498, 9501, 9501, 9501, 9495, 9503,
  9488, 9488, 9481, 9480, 9475, 9477, 9479, 9476, 9474, 9482,
  9448, 9460, 9465, 9473, 9469, 9468, 9472, 9459, 9459, 9454,
  10811, 10815, 10814, 10816, 10811, 10809, 10807, 10807, 10806, 10809,
  10787, 10801, 10793, 10790, 10790, 10787, 10788, 10792, 10791, 10791,
  10760, 10771, 10770, 10769, 10768, 10767, 10766, 10769, 10768, 10771,
  10741, 10749, 10750, 10746, 10746, 10750, 10749, 10751, 10746, 10747,
  10728, 10723, 10726, 10726, 10719, 10723, 10722, 10722, 10716, 10723,
  10706, 10707, 10699, 10698, 10693, 10694, 10697, 10694, 10691, 10699,
  10663, 10675, 10680, 10689, 10685, 10683, 10687, 10672, 10674, 10668,
  12257, 12262, 12261, 12263, 12258, 12258, 12256, 12255, 12252, 12255,
  12232, 12245, 12239, 12235, 12236, 12235, 12235, 12238, 12236, 12235,
  12203, 12212, 12213, 12212, 12211, 12210, 12209, 12211, 12210, 12212,
  12181, 12188, 12190, 12187, 12187, 12189, 12187, 12189, 12184, 12186,
  12164, 12159, 12164, 12164, 12157, 12161, 12159, 12158, 12153, 12159,
  12141, 12142, 12135, 12134, 12129, 12129, 12132, 12129, 12126, 12132,
  12096, 12105, 12110, 12119, 12115, 12112, 12116, 12103, 12105, 12100,
  14049, 14054, 14051, 14054, 14050, 14050, 14048, 14047, 14045, 14045,
  14023, 14035, 14032, 14028, 14028, 14028, 14030, 14030, 14027, 14026,
  13998, 14003, 14005, 14005, 14003, 14003, 14004, 14002, 14001, 14001,
  13975, 13980, 13984, 13980, 13980, 13980, 13979, 13980, 13974, 13977,
  13957, 13952, 13957, 13958, 13954, 13956, 13954, 13952, 13949, 13951,
  13935, 13937, 13931, 13929, 13926, 13925, 13927, 13924, 13923, 13925,
  13895, 13900, 13903, 13910, 13906, 13902, 13905, 13897, 13898, 13894,
  16474, 16476, 16472, 16474, 16470, 16470, 16468, 16466, 16466, 16465,
  16454, 16461, 16458, 16455, 16455, 16455, 16457, 16455, 16452, 16451,
  16439, 16437, 16439, 16440, 16437, 16439, 16439, 16436, 16435, 16433,
  16421, 16423, 16426, 16421, 16423, 16422, 16421, 16420, 16416, 16420,
  16409, 16405, 16407, 16406, 16404, 16405, 16403, 16402, 16400, 16400,
  16394, 16395, 16390, 16388, 16385, 16383, 16384, 16383, 16382, 16379,
  16366, 16367, 16368, 16371, 16367, 16362, 16363, 16360, 16360, 16358,
  18559, 18561, 18556, 18557, 18554, 18552, 18550, 18548, 18547, 18547,
  18546, 18552, 18549, 18545, 18545, 18544, 18546, 18543, 18541, 18542,
  18539, 18536, 18537, 18539, 18537, 18538, 18537, 18534, 18533, 18533,
  18530, 18530, 18531, 18528, 18530, 18529, 18526, 18526, 18524, 18527,
  18524, 18522, 18522, 18521, 18520, 18520, 18518, 18517, 18516, 18514,
  18517, 18518, 18512, 18511, 18508, 18505, 18505, 18506, 18505, 18500,
  18498, 18499, 18499, 18501, 18497, 18493, 18492, 18491, 18491, 18490,
  20567, 20570, 20566, 20566, 20562, 20561, 20559, 20556, 20555, 20554,
  20557, 20565, 20563, 20558, 20558, 20557, 20558, 20555, 20553, 20555,
  20554, 20554, 20554, 20556, 20555, 20555, 20554, 20551, 20551, 20551,
  20551, 20550, 20551, 20550, 20552, 20551, 20546, 20548, 20547, 20549,
  20549, 20546, 20546, 20548, 20548, 20546, 20545, 20543, 20543, 20541,
  20546, 20547, 20541, 20541, 20539, 20535, 20535, 20537, 20537, 20532,
  20533, 20534, 20533, 20535, 20533, 20528, 20526, 20528, 20527, 20527,
  23738, 23740, 23736, 23736, 23732, 23733, 23730, 23728, 23726, 23726,
  23728, 23734, 23734, 23731, 23729, 23729, 23732, 23727, 23725, 23729,
  23725, 23725, 23724, 23730, 23728, 23727, 23729, 23724, 23724, 23725,
  23722, 23721, 23723, 23723, 23725, 23724, 23721, 23723, 23721, 23723,
  23720, 23717, 23716, 23722, 23722, 23719, 23721, 23719, 23720, 23717,
  23715, 23716, 23711, 23714, 23715, 23711, 23710, 23714, 23715, 23710,
  23706, 23706, 23705, 23707, 23704, 23701, 23702, 23707, 23702, 23704,
  26342, 26342, 26336, 26337, 26333, 26336, 26333, 26332, 26332, 26332,
  26332, 26335, 26334, 26333, 26331, 26332, 26338, 26331, 26330, 26335,
  26327, 26328, 26324, 26334, 26330, 26330, 26334, 26327, 26328, 26329,
  26322, 26320, 26324, 26323, 26326, 26324, 26324, 26325, 26324, 26329,
  26317, 26313, 26311, 26320, 26321, 26320, 26321, 26320, 26323, 26321,
  26305, 26307, 26303, 26310, 26313, 26309, 26308, 26312, 26315, 26310,
  26298, 26300, 26300, 26300, 26296, 26293, 26296, 26305, 26297, 26302,
  28228, 28228, 28220, 28220, 28218, 28221, 28220, 28218, 28219, 28220,
  28218, 28221, 28218, 28218, 28217, 28218, 28224, 28218, 28217, 28222,
  28213, 28214, 28207, 28220, 28214, 28215, 28220, 28214, 28215, 28217,
  28205, 28203, 28208, 28207, 28210, 28209, 28209, 28210, 28212, 28217,
  28199, 28194, 28189, 28202, 28204, 28204, 28204, 28203, 28210, 28208,
  28181, 28182, 28177, 28188, 28193, 28189, 28187, 28193, 28196, 28193,
  28175, 28179, 28177, 28177, 28171, 28168, 28172, 28184, 28174, 28182,
  30940, 30937, 30926, 30925, 30926, 30930, 30930, 30926, 30930, 30932,
  30930, 30930, 30924, 30924, 30925, 30926, 30933, 30926, 30927, 30933,
  30922, 30924, 30911, 30928, 30920, 30922, 30930, 30924, 30927, 30928,
  30912, 30911, 30916, 30914, 30916, 30917, 30917, 30919, 30925, 30931,
  30905, 30898, 30891, 30906, 30909, 30912, 30910, 30912, 30923, 30921,
  30879, 30880, 30874, 30891, 30897, 30890, 30888, 30898, 30902, 30899,
  30872, 30879, 30877, 30877, 30867, 30867, 30871, 30889, 30876, 30888,
  33338, 33332, 33318, 33317, 33319, 33326, 33326, 33322, 33328, 33330,
  33326, 33323, 33315, 33316, 33318, 33321, 33328, 33321, 33325, 33331,
  33316, 33317, 33303, 33323, 33314, 33316, 33325, 33320, 33325, 33327,
  33305, 33305, 33311, 33308, 33310, 33313, 33311, 33316, 33326, 33331,
  33299, 33291, 33282, 33298, 33302, 33307, 33304, 33310, 33322, 33321,
  33267, 33269, 33261, 33282, 33290, 33281, 33280, 33293, 33299, 33295,
  33258, 33268, 33266, 33268, 33256, 33258, 33264, 33285, 33271, 33284,
  35642, 35635, 35619, 35617, 35621, 35632, 35630, 35626, 35633, 35636,
  35630, 35622, 35614, 35617, 35619, 35624, 35632, 35624, 35628, 35636,
  35618, 35618, 35603, 35626, 35616, 35619, 35627, 35623, 35630, 35631,
  35606, 35607, 35612, 35611, 35612, 35616, 35613, 35619, 35632, 35635,
  35600, 35592, 35583, 35601, 35606, 35610, 35609, 35616, 35628, 35627,
  35566, 35570, 35564, 35586, 35596, 35585, 35585, 35599, 35607, 35603,
  35556, 35568, 35566, 35570, 35557, 35561, 35570, 35594, 35578, 35592,
  39247, 39241, 39225, 39225, 39228, 39241, 39239, 39234, 39240, 39243,
  39235, 39222, 39217, 39224, 39225, 39231, 39239, 39231, 39233, 39243,
  39224, 39220, 39207, 39233, 39225, 39228, 39233, 39228, 39237, 39238,
  39208, 39209, 39211, 39216, 39218, 39220, 39220, 39226, 39239, 39240,
  39201, 39196, 39189, 39209, 39216, 39219, 39222, 39226, 39237, 39235,
  39168, 39176, 39176, 39195, 39210, 39201, 39202, 39213, 39223, 39221,
  39158, 39171, 39171, 39173, 39168, 39173, 39185, 39206, 39191, 39208,
  42213, 42211, 42199, 42199, 42201, 42213, 42211, 42207, 42210, 42214,
  42200, 42191, 42189, 42197, 42198, 42203, 42211, 42205, 42205, 42214,
  42191, 42188, 42180, 42202, 42198, 42200, 42205, 42200, 42208, 42209,
  42175, 42176, 42177, 42186, 42190, 42190, 42192, 42198, 42207, 42207,
  42166, 42166, 42158, 42178, 42188, 42189, 42193, 42194, 42204, 42205,
  42137, 42147, 42150, 42163, 42180, 42174, 42174, 42183, 42192, 42193,
  42126, 42138, 42138, 42140, 42141, 42146, 42158, 42173, 42162, 42180,
  44410, 44410, 44401, 44403, 44403, 44413, 44412, 44409, 44410, 44413,
  44397, 44391, 44391, 44399, 44401, 44403, 44411, 44408, 44407, 44415,
  44389, 44387, 44382, 44400, 44399, 44400, 44405, 44401, 44407, 44409,
  44375, 44374, 44374, 44384, 44390, 44390, 44392, 44398, 44403, 44405,
  44364, 44366, 44359, 44376, 44386, 44386, 44390, 44391, 44401, 44402,
  44337, 44348, 44353, 44361, 44376, 44374, 44373, 44380, 44388, 44391,
  44325, 44335, 44336, 44338, 44343, 44348, 44359, 44369, 44362, 44379,
  47505, 47507, 47502, 47505, 47505, 47513, 47512, 47511, 47512, 47513,
  47492, 47491, 47492, 47499, 47503, 47503, 47511, 47511, 47510, 47515,
  47485, 47483, 47483, 47496, 47499, 47499, 47504, 47502, 47507, 47510,
  47472, 47471, 47470, 47481, 47488, 47489, 47491, 47497, 47500, 47502,
  47457, 47461, 47455, 47471, 47481, 47479, 47484, 47486, 47496, 47498,
  47429, 47442, 47447, 47452, 47467, 47468, 47468, 47474, 47482, 47485,
  47412, 47422, 47424, 47429, 47437, 47442, 47452, 47458, 47457, 47472 ;

 TempPrsLvls_D = 1000, 925, 850, 700, 600, 500, 400, 300, 250, 200, 150, 100, 
    70, 50, 30, 20, 15, 10, 7, 5, 3, 2, 1.5, 1 ;

 datamonth = 200501 ;

 lat = 25.5, 26.5, 27.5, 28.5, 29.5, 30.5, 31.5 ;

 lat_bnds =
  25, 26,
  26, 27,
  27, 28,
  28, 29,
  29, 30,
  30, 31,
  31, 32 ;

 lon = -97.5, -96.5, -95.5, -94.5, -93.5, -92.5, -91.5, -90.5, -89.5, -88.5 ;

 lon_bnds =
  -98, -97,
  -97, -96,
  -96, -95,
  -95, -94,
  -94, -93,
  -93, -92,
  -92, -91,
  -91, -90,
  -90, -89,
  -89, -88 ;

 time = 1104537600 ;

 time_bnds =
  1104537600, 1107215999 ;
}
netcdf ref {
dimensions:
	time = UNLIMITED ; // (1 currently)
	lat = 7 ;
	lon = 10 ;
	latv = 2 ;
	lonv = 2 ;
	nv = 2 ;
variables:
	float x_AIRX3STM_006_GPHeight_A(time, lat, lon) ;
		x_AIRX3STM_006_GPHeight_A:_FillValue = -9999.f ;
		x_AIRX3STM_006_GPHeight_A:standard_name = "geopotential_height" ;
		x_AIRX3STM_006_GPHeight_A:quantity_type = "Geopotential" ;
		x_AIRX3STM_006_GPHeight_A:product_short_name = "AIRX3STM" ;
		x_AIRX3STM_006_GPHeight_A:product_version = "006" ;
		x_AIRX3STM_006_GPHeight_A:long_name = "Geopotential Height (Daytime/Ascending)" ;
		x_AIRX3STM_006_GPHeight_A:coordinates = "time lat lon" ;
		x_AIRX3STM_006_GPHeight_A:units = "m" ;
		x_AIRX3STM_006_GPHeight_A:cell_methods = "TempPrsLvls_A: mean" ;
	float TempPrsLvls_A ;
		TempPrsLvls_A:long_name = "Pressure" ;
		TempPrsLvls_A:format = "F7.2" ;
		TempPrsLvls_A:standard_name = "stdpressurelev" ;
		TempPrsLvls_A:units = "hPa" ;
		TempPrsLvls_A:cell_methods = "TempPrsLvls_A: mean" ;
	int datamonth(time) ;
		datamonth:long_name = "Standardized Date Label" ;
	double lat(lat) ;
		lat:units = "degrees_north" ;
		lat:format = "F5.1" ;
		lat:missing_value = -9999.f ;
		lat:standard_name = "latitude" ;
		lat:bounds = "lat_bnds" ;
	double lat_bnds(lat, latv) ;
		lat_bnds:units = "degrees_north" ;
	double lon(lon) ;
		lon:units = "degrees_east" ;
		lon:format = "F6.1" ;
		lon:missing_value = -9999.f ;
		lon:standard_name = "longitude" ;
		lon:bounds = "lon_bnds" ;
	double lon_bnds(lon, lonv) ;
		lon_bnds:units = "degrees_east" ;
	int time(time) ;
		time:long_name = "time" ;
		time:standard_name = "time" ;
		time:units = "seconds since 1970-01-01 00:00:00" ;
		time:bounds = "time_bnds" ;
	int time_bnds(time, nv) ;
		time_bnds:units = "seconds since 1970-01-01 00:00:00" ;
	float y_AIRX3STM_006_GPHeight_D(time, lat, lon) ;
		y_AIRX3STM_006_GPHeight_D:_FillValue = -9999.f ;
		y_AIRX3STM_006_GPHeight_D:standard_name = "geopotential_height" ;
		y_AIRX3STM_006_GPHeight_D:quantity_type = "Geopotential" ;
		y_AIRX3STM_006_GPHeight_D:product_short_name = "AIRX3STM" ;
		y_AIRX3STM_006_GPHeight_D:product_version = "006" ;
		y_AIRX3STM_006_GPHeight_D:long_name = "Geopotential Height (Nighttime/Descending)" ;
		y_AIRX3STM_006_GPHeight_D:coordinates = "time lat lon" ;
		y_AIRX3STM_006_GPHeight_D:units = "m" ;
		y_AIRX3STM_006_GPHeight_D:cell_methods = "TempPrsLvls_D: mean" ;

// global attributes:
		:Conventions = "CF-1.4" ;
		:start_time = "2005-01-01T00:00:00Z" ;
		:end_time = "2005-01-31T23:59:59Z" ;
		:temporal_resolution = "monthly" ;
		:NCO = "\"4.5.3\"" ;
		:nco_openmp_thread_number = 1 ;
		:matched_start_time = "2005-01-01T00:00:00Z" ;
		:matched_end_time = "2005-01-31T23:59:59Z" ;
		:userstartdate = "2005-01-01T00:00:00Z" ;
		:userenddate = "2005-01-31T23:59:59Z" ;
		:title = "Scatter (Static) of Geopotential Height (Nighttime/Descending) monthly 1 deg. @1000hPa [AIRS AIRX3STM v006] m vs Geopotential Height (Daytime/Ascending) monthly 1 deg. @700hPa [AIRS AIRX3STM v006] m" ;
data:

 x_AIRX3STM_006_GPHeight_A =
  3155, 3156, 3158, 3160, 3161, 3160, 3161, 3161, 3162, 3162,
  3155, 3155, 3157, 3157, 3163, 3163, 3160, 3159, 3159, 3158,
  3151, 3152, 3154, 3154, 3158, 3160, 3159, 3158, 3156, 3156,
  3146, 3149, 3152, 3148, 3153, 3156, 3155, 3155, 3153, 3152,
  3145, 3145, 3144, 3147, 3148, 3154, 3146, 3150, 3150, 3146,
  3140, 3141, 3141, 3139, 3141, 3144, 3142, 3142, 3144, 3142,
  3135, 3135, 3137, 3140, 3143, 3144, 3140, 3141, 3142, 3139 ;

 TempPrsLvls_A = 700 ;

 datamonth = 200501 ;

 lat = 25.5, 26.5, 27.5, 28.5, 29.5, 30.5, 31.5 ;

 lat_bnds =
  25, 26,
  26, 27,
  27, 28,
  28, 29,
  29, 30,
  30, 31,
  31, 32 ;

 lon = -97.5, -96.5, -95.5, -94.5, -93.5, -92.5, -91.5, -90.5, -89.5, -88.5 ;

 lon_bnds =
  -98, -97,
  -97, -96,
  -96, -95,
  -95, -94,
  -94, -93,
  -93, -92,
  -92, -91,
  -91, -90,
  -90, -89,
  -89, -88 ;

 time = 1104537600 ;

 time_bnds =
  1104537600, 1107215999 ;

 y_AIRX3STM_006_GPHeight_D =
  168, 169, 169, 171, 176, 180, 179, 177, 177, 177,
  171, 169, 168, 174, 180, 181, 183, 182, 182, 180,
  176, 176, 176, 180, 182, 184, 187, 187, 185, 186,
  179, 181, 181, 185, 187, 187, 192, 191, 189, 187,
  198, 187, 188, 190, 191, 191, 192, 191, 193, 193,
  222, 199, 192, 191, 193, 194, 191, 192, 192, 195,
  238, 210, 201, 191, 190, 191, 192, 197, 196, 192 ;
}
